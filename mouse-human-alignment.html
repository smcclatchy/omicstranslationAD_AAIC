<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en" data-bs-theme="auto"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><title>Omics Translation in AD: Mouse-human alignment of transcriptomic signatures</title><meta name="viewport" content="width=device-width, initial-scale=1"><script src="assets/themetoggle.js"></script><link rel="stylesheet" type="text/css" href="assets/styles.css"><script src="assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="favicons//apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="favicons//favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="favicons//favicon-16x16.png"><link rel="manifest" href="favicons//site.webmanifest"><link rel="mask-icon" href="favicons//safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="black"></head><body>
    <header id="top" class="navbar navbar-expand-md top-nav "><svg xmlns="http://www.w3.org/2000/svg" class="d-none"><symbol id="check2" viewbox="0 0 16 16"><path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"></path></symbol><symbol id="circle-half" viewbox="0 0 16 16"><path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"></path></symbol><symbol id="moon-stars-fill" viewbox="0 0 16 16"><path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"></path><path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"></path></symbol><symbol id="sun-fill" viewbox="0 0 16 16"><path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"></path></symbol></svg><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-8">
      <div class="large-logo">
        <img id="-logo" alt="" src="assets/images/-logo.svg"><span class="badge text-bg-danger">
          <abbr title="This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.">
            <a href="https://cdh.carpentries.org/the-lesson-life-cycle.html#early-development-pre-alpha-through-alpha" class="external-link alert-link">
              <i aria-hidden="true" class="icon" data-feather="alert-octagon" style="border-radius: 5px"></i>
              Pre-Alpha
            </a>
            <span class="visually-hidden">This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.</span>
          </abbr>
        </span>

      </div>
    </div>
    <div class="selector-container">
      <div id="theme-selector">
        <li class="nav-item dropdown" id="theme-button-list">
          <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
            <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="bd-theme-text"><li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                Light
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                Dark
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                Auto
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
          </ul></li>
      </div>

      <div class="dropdown" id="instructor-dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Learner View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li><button class="dropdown-item" type="button" onclick="window.location.href='instructor/mouse-human-alignment.html';">Instructor View</button></li>
        </ul></div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl bottom-nav " aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="" src="assets/images/-logo-sm.svg"></div>
    <div class="lesson-title-md">
      Omics Translation in AD
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Search the All In One page" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class="nav-item">
          <span class="lesson-title">
            Omics Translation in AD
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="reference.html#glossary">Glossary</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="profiles.html">Learner Profiles</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown"><li><a class="dropdown-item" href="reference.html">Reference</a></li>
          </ul></li>
      </ul></div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Search the All In One page"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a id="search-button" class="btn btn-primary" href="aio.html" role="button" aria-label="Search the All In One page">Search the All In One page</a>
  </div><!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Omics Translation in AD
</div>

<aside class="col-md-12 lesson-progress"><div style="width: 52%" class="percentage">
    52%
  </div>
  <div class="progress ">
    <div class="progress-bar " role="progressbar" style="width: 52%" aria-valuenow="52" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row" id="theme-row-mobile">
            <div class="col" id="theme-selector">
              <li class="nav-item dropdown" id="theme-button-list">
                <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
                  <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><span class="d-lg-none ms-1" id="bd-theme-text">Toggle Theme</span>
                </button>
                <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="bd-theme-text"><li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                      Light
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                      Dark
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                      <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                      Auto
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                </ul></li>
            </div>
          </div>
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Learner View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="instructor/mouse-human-alignment.html">Instructor View</a>
                      </div>
                    </div>
                  </div><!--/div.accordion-item-->
                </div><!--/div.accordion-flush-->
              </div><!--div.sidenav-view-selector -->
            </div><!--/div.col -->

            <hr></div><!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Setup</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="introduction.html">1. Introduction to Omics Translation in AD</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="exploring-data-in-synapse.html">2. Synapse and AD Knowledge Portal</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="differential-expression-analysis.html">3. Differential expression analysis</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlushcurrent">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-headingcurrent">
      <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapsecurrent" aria-expanded="true" aria-controls="flush-collapsecurrent">
        <span class="visually-hidden">Current Chapter</span>
        <span class="current-chapter">
        4. Mouse-human alignment of transcriptomic signatures
        </span>
      </button>
    </div><!--/div.accordion-header-->

    <div id="flush-collapsecurrent" class="accordion-collapse collapse show" aria-labelledby="flush-headingcurrent" data-bs-parent="#accordionFlushcurrent">
      <div class="accordion-body">
        <ul><li><a href="#aligning-human-and-mouse-phenotype">Aligning Human and Mouse Phenotype</a></li>
<li><a href="#overview-of-human-cohort-data">Overview of Human cohort data</a></li>
<li><a href="#overview-of-human-consensus-rna-seq-coexpression-modules">Overview of Human Consensus RNA-Seq Coexpression Modules</a></li>
<li><a href="#accessing-amp-ad-module-data">Accessing AMP-AD module data</a></li>
<li><a href="#reading-differential-expression-result-of-human-data-from-meta-analysis">Reading differential expression result of human data from
meta-analysis</a></li>
<li><a href="#correlation-between-mouse-models-and-human-ad-modules">Correlation between mouse models and human AD modules</a></li>
<li><a href="#detecting-functional-coherence-of-gene-sets-from-omics-data">Detecting functional coherence of gene sets from omics data</a></li>
<li><a href="#alzheimerss-disease-biological-domains">Alzheimers’s Disease Biological Domains</a></li>
<li><a href="#session-info">Session Info</a></li>
        </ul></div><!--/div.accordion-body-->
    </div><!--/div.accordion-collapse-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width"><div class="accordion accordion-flush lesson-resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="lesson-resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul><li>
                        <a href="key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="reference.html#glossary">Glossary</a>
                      </li>
                      <li>
                        <a href="profiles.html">Learner Profiles</a>
                      </li>
                      <li><a href="reference.html">Reference</a></li>
                    </ul></div>
                </div>
              </div>
            </div>
            <hr class="half-width lesson-resources"><a href="aio.html">See all in one page</a>


            <hr class="d-none d-sm-block d-md-none"><div class="d-grid gap-1">

            </div>
          </div><!-- /div.accordion -->
        </div><!-- /div.sidebar-inner -->
      </nav></div><!-- /div.sidebar -->
  </div><!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-instructor.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <nav class="lesson-content mx-md-4" aria-label="Previous and Next Chapter"><!-- content for small screens --><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="differential-expression-analysis.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="index.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="differential-expression-analysis.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: Differential
        </a>
        <a class="chapter-link float-end" href="index.html" rel="next">
          Home
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
      <hr></nav><main id="main-content" class="main-content"><div class="container lesson-content">
        <h1>Mouse-human alignment of transcriptomic signatures</h1>
        <p>Last updated on 2024-11-19 |

        <a href="https://github.com/carpentries/workbench-template-md/edit/main/episodes/mouse-human-alignment.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>



        <div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>

        

<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul><li>How do we perform a cross-species comparison?</li>
<li>Which aspects of disease does a model capture?</li>
</ul></div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul><li>Approaches to align mouse data to human data</li>
<li>Understand the human AD co-expression modules</li>
<li>Perform correlation analysis</li>
<li>Understand the biological domains of Alzheimer’s disease</li>
<li>Use biological domain annotations to compare between species</li>
</ul></div>
</div>
</div>
</div>
</div>
<p>Author: Gregory Cary, Jackson Laboratory</p>
<section><h2 class="section-heading" id="aligning-human-and-mouse-phenotype">Aligning Human and Mouse Phenotype<a class="anchor" aria-label="anchor" href="#aligning-human-and-mouse-phenotype"></a></h2>
<hr class="half-width"><p>Alzheimer’s Disease (AD) is complex, and we can not expect any animal
model to fully recapitulate all aspects of late onset AD (LOAD)
pathology. To study AD with animal models we must find dimensions
through which we can align phenotypes between the models and human
cohorts. In MODEL-AD we use the following data modalities to identify
commonalities between mouse models and human cohorts:</p>
<ol style="list-style-type: decimal"><li>Imaging (i.e. MRI and PET) to correspond with human imaging studies
(e.g.  <a href="https://adni.loni.usc.edu/" class="external-link">ADNI</a>)<br></li>
<li>Neuropathological phenotypes<br></li>
<li>
<em>Lots</em> of ’omics — genomics, proteomics, and
metabolomics</li>
</ol><p>The ’omics comparisons allow for a much richer contrast, since a
significant portion of genes are shared between these two species.
Homology at the anatomical and neuropathological levels is less
clear.</p>
<figure><img src="fig/rmd04-dimensions_of_model_alignment.png" alt="Aligning Human and Mouse Phenotypes" class="figure mx-auto d-block"><div class="figcaption">Aligning Human and Mouse Phenotypes</div>
</figure></section><section><h2 class="section-heading" id="overview-of-human-cohort-data">Overview of Human cohort data<a class="anchor" aria-label="anchor" href="#overview-of-human-cohort-data"></a></h2>
<hr class="half-width"><p>The Accelerating Medicines Partnership-Alzheimer’s Disease Consortium
<a href="https://adknowledgeportal.synapse.org/Explore/Programs/DetailsPage?Program=AMP-AD" class="external-link">(AMP-AD)</a>
has generated extensive sets of ’omics data from a variety of human
Alzheimer’s disease cohorts. AMP-AD researchers are applying systems
biology approaches toward the goal of elucidating AD mechanisms and
highlighting potential therapeutic targets.</p>
<p>There are three large, independent human cohorts that are part of
AMP-AD:</p>
<ol style="list-style-type: decimal"><li>The Religious Orders Study and the Memory and Aging Project (<a href="https://adknowledgeportal.synapse.org/Explore/Studies/DetailsPage/StudyDetails?Study=syn3219045" class="external-link">ROSMAP,
syn3219045</a>)</li>
<li>Mount Sinai Brain Bank (<a href="https://adknowledgeportal.synapse.org/Explore/Studies/DetailsPage/StudyDetails?Study=syn3159438" class="external-link">MSBB,
syn3159438</a>)<br></li>
<li>Mayo Clinic (<a href="https://adknowledgeportal.synapse.org/Explore/Studies/DetailsPage/StudyDetails?Study=syn5550404" class="external-link">Mayo,
syn5550404</a>)</li>
</ol><p>These studies have collected postmortem RNA-seq profiles from over
1,200 individuals spanning seven distinct brain regions: - dorsolateral
prefrontal cortex (DLPFC)<br>
- temporal cortex (TCX)<br>
- inferior frontal gyrus (IFG)<br>
- superior temporal gyrus (STG)<br>
- frontal pole (FP)<br>
- parahippocampal gyrus (PHG)<br>
- cerebellum (CBE)</p>
<p>These samples are generally balanced for AD, MCI, and non-affected
controls. The data provide a broad assessment on how AD affects multiple
brain regions in 3 different populations in the US.</p>
<figure><img src="fig/rmd04-ampad_studies_regions.png" alt="Transcriptomic studies of Alzheimer’s Disease" class="figure mx-auto d-block"><div class="figcaption">Transcriptomic studies of Alzheimer’s
Disease</div>
</figure><p>Today we’ll consider two different approaches to compare gene
expression between human cohorts and model systems:</p>
<ol style="list-style-type: decimal"><li>Correlation within co-expression module genes</li>
</ol><ul><li>correlations will be generally weak for all expression, but animal
models may recapitulate specific aspects of the disease</li>
<li>we can use subsets of genes from co-expression modules, which
represent genes expressed in similar patterns in AD, and look for
correlations within these subsets</li>
</ul><ol start="2" style="list-style-type: decimal"><li>Correlation of functional enrichment results</li>
</ol><ul><li>another approach is to consider the functional annotation enriched
among differentially expressed genes in human and mouse</li>
<li>we can similarly sub-divide these groups of co-functional genes into
biological domains to aid our interpretation</li>
</ul></section><section><h2 class="section-heading" id="overview-of-human-consensus-rna-seq-coexpression-modules">Overview of Human Consensus RNA-Seq Coexpression Modules<a class="anchor" aria-label="anchor" href="#overview-of-human-consensus-rna-seq-coexpression-modules"></a></h2>
<hr class="half-width"><p><a href="https://doi.org/10.1016/j.celrep.2020.107908" class="external-link">Wan, et
al.</a> performed meta analysis including all available AMP-AD RNA-seq
datasets and systematically defined correspondences between gene
expression changes associated with AD in human brains. Briefly, the
RNA-seq read libraries were normalized and covariates were adjusted for
each human study separately before testing for differential expression
using fixed/mixed effects modeling to account for batch effects. The
expression data from each brain region was used to perform co-expression
analysis using a variety of different algorithms, generating in total
2,978 co-expression modules across all tissues. Of these, 660 modules
showed enrichment for at least one AD-specific differentially expressed
gene from the meta-analysis of all cases compared to controls.</p>
<p>Wan <em>et al</em> clustered these modules together using network
analyses and found 30 co-expression modules related to LOAD pathology.
Among the 30 aggregate co-expression modules, five consensus clusters
were described that span brain region and study cohorts. These consensus
clusters consist of subsets of modules which are associated with similar
AD related changes across brain regions and cohorts. Wan <em>et al</em>
looked for enrichment of cell -type signatures within the modules using
expression-weighted cell type enrichment analysis (<a href="https://doi.org/10.3389/fnins.2016.00016" class="external-link">Skene and Grant,
2016</a>) and examined enrichment of functional annotations within the
modules.</p>
<figure><img src="fig/rmd04-consensus_clusters.png" alt="AMP-AD GENE Modules" class="figure mx-auto d-block"><div class="figcaption">AMP-AD GENE Modules</div>
</figure><p>This figure shows a matrix view of gene content overlap between the
30 co-expression modules. You’ll note a few strongly overlapping group
of modules, implicating similar expression profiles in different studies
and brain regions, which are the consensus clusters (A-E).</p>
<p>The first module block (consensus cluster A) is enriched for
signatures of astrocytes, while the next block (consensus cluster B) is
enriched for signatures of other cell types, including endothelial and
microglial expressed genes, suggesting an inflammation component. The
third module block (consensus cluster C) is strongly enriched for
signatures of neuronal gene expression, linking the modules within this
cluster to neurodegenerative processes. The fourth module block
(consensus cluster D) is enriched for oligodendrocyte and other glial
genes, indicating myelination and other neuronal support functions
associated with these modules. Finally, consensus cluster E contains
mixed modules that don’t have clear cell type enrichments, but do have
enrichments for processes involved in response to stress or unfolded
proteins. Stress response is not cell specific, so the expression
represented by these modules may be throughout many cells in the
brain.</p>
</section><section><h2 class="section-heading" id="accessing-amp-ad-module-data">Accessing AMP-AD module data<a class="anchor" aria-label="anchor" href="#accessing-amp-ad-module-data"></a></h2>
<hr class="half-width"><p>These AMP-AD co-expression modules are very useful for making
comparisons between animal models and the human cohorts. In order to use
these modules to make the comparisons, we’ll need to download data
pertaining to the 30 co-expression modules. These data are available
from the <a href="https://www.synapse.org/Synapse:syn11932957" class="external-link">Synapse
data repository</a>; let’s download and take a closer look at the
data.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">query</span> <span class="op">&lt;-</span> <span class="fu">synTableQuery</span><span class="op">(</span><span class="st">"SELECT * FROM syn11932957"</span><span class="op">)</span></span>
<span><span class="va">module_table</span> <span class="op">&lt;-</span> <span class="fu">read.table</span><span class="op">(</span><span class="va">query</span><span class="op">$</span><span class="va">filepath</span>, sep <span class="op">=</span> <span class="st">","</span>,header <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
<p>Let’s look at module table</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">head</span><span class="op">(</span><span class="va">module_table</span><span class="op">)</span></span></code></pre>
</div>
<p>Here you see 9 columns in this table. Columns we’re interested in
are:</p>
<ul><li>column 3: <code>GeneID</code> contains Ensembl gene IDs<br></li>
<li>column 4: <code>Module</code> is the module name in which gene is
clustered<br></li>
<li>column 7: <code>brainRegion</code> is the tissue of the
corresponding module<br></li>
<li>column 9: <code>external_gene_name</code> are gene symbols</li>
</ul><p>How many unique modules are in the table?</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">length</span><span class="op">(</span><span class="fu">unique</span><span class="op">(</span><span class="va">module_table</span><span class="op">$</span><span class="va">Module</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<p>What are the names of the modules?</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">unique</span><span class="op">(</span><span class="va">module_table</span><span class="op">$</span><span class="va">Module</span><span class="op">)</span></span></code></pre>
</div>
<p>How many genes are in each module?</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">table</span><span class="op">(</span><span class="va">module_table</span><span class="op">$</span><span class="va">Module</span><span class="op">)</span></span></code></pre>
</div>
<p>We can visualize this as bar plot using ggplot2 package.</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">module_table</span>,<span class="fu">aes</span><span class="op">(</span>y<span class="op">=</span><span class="va">Module</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> </span></code></pre>
</div>
<div id="challenge-1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-1" class="callout-inner">
<h3 class="callout-title">Challenge 1</h3>
<div class="callout-content">
<p>What are other ways to count genes in each module?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu">count</span><span class="op">(</span><span class="va">module_table</span>, <span class="va">Module</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<p>We can also check the total number of unique genes in the table</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">length</span><span class="op">(</span><span class="fu">unique</span><span class="op">(</span><span class="va">module_table</span><span class="op">$</span><span class="va">GeneID</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="mouse-orthologs-of-human-module-genes">Mouse orthologs of Human module genes<a class="anchor" aria-label="anchor" href="#mouse-orthologs-of-human-module-genes"></a></h4>
<p>In the module table we’ve downloaded we have human ENSEMBL ids and
human gene symbols. In order to compare between human and mouse models,
we will need to identify the corresponding mouse gene IDs. We are going
to add the gene IDs of orthologous genes in mouse to the corresponding
human genes in the module table.</p>
<p>Orthology mapping can be tricky, but thankfully Wan <em>et al</em>
have already identified mouse orthologs for each of the human genes
using the HGNC Comparison of Orthology Predictions (<a href="https://www.genenames.org/tools/hcop/" class="external-link">HCOP</a>) tool. While there
are a variety of different ways to get data about gene orthology, for
the sake of simplicity we are going to read that table from <a href="https://doi.org/10.7303/syn17010253.1" class="external-link">Synapse</a>.</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mouse.human.ortho</span> <span class="op">&lt;-</span> <span class="fu">fread</span><span class="op">(</span><span class="fu">synapser</span><span class="fu">::</span><span class="fu">synGet</span><span class="op">(</span><span class="st">"syn17010253"</span><span class="op">)</span><span class="op">$</span><span class="va">path</span>,check.names <span class="op">=</span> <span class="cn">F</span>,header<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span></code></pre>
</div>
<p>Let’s take a look at the first few rows of this orthology table:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">head</span><span class="op">(</span><span class="va">mouse.human.ortho</span><span class="op">)</span></span></code></pre>
</div>
<p>There are 15 columns with various gene identifiers for each species.
We’ll add mouse gene symbols from the ortholog table to the module table
by matching the human ENSEMBL IDs from both tables.</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">module_table</span><span class="op">$</span><span class="va">Mouse_gene_name</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">mouse.human.ortho</span><span class="op">$</span><span class="va">mouse_symbol</span><span class="op">[</span></span>
<span>    <span class="fu">match</span><span class="op">(</span><span class="va">module_table</span><span class="op">$</span><span class="va">GeneID</span>,<span class="va">mouse.human.ortho</span><span class="op">$</span><span class="va">human_ensembl_gene</span><span class="op">)</span></span>
<span>    <span class="op">]</span></span></code></pre>
</div>
<p>Taking a look at the module table, we can see the new column of mouse
orthologs we just added.</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">head</span><span class="op">(</span><span class="va">module_table</span><span class="op">)</span></span></code></pre>
</div>
<p>Some genes don’t have identified orthologs. Also there’s some
redundant information. Let’s only keep the columns of interest and rows
that contain a mouse ortholog mapping:</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ampad_modules</span> <span class="op">&lt;-</span> <span class="va">module_table</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">distinct</span><span class="op">(</span>tissue <span class="op">=</span> <span class="va">brainRegion</span>, module <span class="op">=</span> <span class="va">Module</span>, gene <span class="op">=</span> <span class="va">GeneID</span>, <span class="va">Mouse_gene_name</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">Mouse_gene_name</span> <span class="op">!=</span> <span class="st">""</span><span class="op">)</span></span></code></pre>
</div>
<p>Take a look at this new data table:</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">head</span><span class="op">(</span><span class="va">ampad_modules</span><span class="op">)</span></span></code></pre>
</div>
<div id="challenge-2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-2" class="callout-inner">
<h3 class="callout-title">Challenge 2</h3>
<div class="callout-content">
<p>How many human genes are we removing that don’t have identified
orthologs?</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu">filter</span><span class="op">(</span><span class="va">module_table</span>, <span class="fu">is.na</span><span class="op">(</span><span class="va">Mouse_gene_name</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">select</span><span class="op">(</span><span class="va">external_gene_name</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">distinct</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">nrow</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="reading-differential-expression-result-of-human-data-from-meta-analysis">Reading differential expression result of human data from
meta-analysis<a class="anchor" aria-label="anchor" href="#reading-differential-expression-result-of-human-data-from-meta-analysis"></a></h2>
<hr class="half-width"><p>Now we know the genes that are in each AMP-AD co-expression cluster,
along with the ID of the corresponding orthologous gene in mouse. We’ll
also need to know how these genes change expression in AD.</p>
<p>We’ll download the results from differential expression meta-analysis
of reprocessed AMP-AD RNA-seq data (all 7 brain regions). Log fold
change values for human transcripts can be obtained from <a href="https://www.synapse.org/#!Synapse:syn14237651" class="external-link">Synapse</a>.</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ampad_modules_raw</span> <span class="op">&lt;-</span> <span class="fu">fread</span><span class="op">(</span><span class="fu">synapser</span><span class="fu">::</span><span class="fu">synGet</span><span class="op">(</span><span class="st">"syn14237651"</span><span class="op">)</span><span class="op">$</span><span class="va">path</span>,check.names <span class="op">=</span> <span class="cn">F</span>,header<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span></code></pre>
</div>
<p>Let’s take a look at these data</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">head</span><span class="op">(</span><span class="va">ampad_modules_raw</span><span class="op">)</span></span></code></pre>
</div>
<p>Data from which tissues are in this table?</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">unique</span><span class="op">(</span><span class="va">ampad_modules_raw</span><span class="op">$</span><span class="va">Tissue</span><span class="op">)</span></span></code></pre>
</div>
<p>All 7 brain regions are represented.</p>
<p>The AMP-AD data has been processed many ways and using different
models and comparisons. Let’s take a look at how many ways the data have
been analyzed:</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ampad_modules_raw</span> <span class="op">%&gt;%</span> <span class="fu">select</span><span class="op">(</span><span class="va">Model</span>, <span class="va">Comparison</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">distinct</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<p>For our analyses we’ll use data from the “Diagnosis” model and
comparisons between AD cases vs controls. We’ll filter the table for
these conditions and only keep the three columns we’ll need:
<code>Tissue</code>, <code>Gene</code> and <code>logFC</code>.</p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ampad_fc</span> <span class="op">&lt;-</span> <span class="va">ampad_modules_raw</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">as_tibble</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">Model</span> <span class="op">==</span> <span class="st">"Diagnosis"</span>, <span class="va">Comparison</span> <span class="op">==</span> <span class="st">"AD-CONTROL"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">select</span><span class="op">(</span>tissue <span class="op">=</span> <span class="va">Tissue</span>, gene <span class="op">=</span> <span class="va">ensembl_gene_id</span>, ampad_fc <span class="op">=</span> <span class="va">logFC</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">distinct</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="combine-with-modules-so-correlation-can-be-done-per-module">Combine with modules so correlation can be done per module<a class="anchor" aria-label="anchor" href="#combine-with-modules-so-correlation-can-be-done-per-module"></a></h4>
<p>Next, we will combine the fold change table we just downloaded
(<code>ampad_fc</code>) and module table from before
(<code>ampad_modules</code>). First, let’s look at both tables to check
how can we merge them together?</p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">head</span><span class="op">(</span><span class="va">ampad_fc</span><span class="op">)</span></span>
<span><span class="fu">head</span><span class="op">(</span><span class="va">ampad_modules</span><span class="op">)</span></span></code></pre>
</div>
<p>The columns common to both tables are <code>gene</code> (the human
Ensembl gene IDs) and <code>tissue</code> (the brain region
corresponding to the module/measurement). So we will merge the data sets
using these two columns.</p>
<p><strong>Reminder</strong>: Each gene can be present in multiple brain
regions, but should only be in one module per brain region. Let’s double
check using the first gene in the table:</p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ampad_modules</span><span class="op">[</span><span class="va">ampad_modules</span><span class="op">$</span><span class="va">gene</span> <span class="op">%in%</span> <span class="st">"ENSG00000168439"</span>,<span class="op">]</span></span></code></pre>
</div>
<p>This gene is present in six different co-expression modules all from
different brain regions. You can do this for any other gene as well.</p>
<p>We’ll merge the two tables using the <code>dplyr::inner_join</code>
function:</p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ampad_modules_fc</span> <span class="op">&lt;-</span> <span class="fu">inner_join</span><span class="op">(</span><span class="va">ampad_modules</span>, <span class="va">ampad_fc</span>, by <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"gene"</span>, <span class="st">"tissue"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">select</span><span class="op">(</span>symbol <span class="op">=</span> <span class="va">Mouse_gene_name</span>, <span class="va">module</span>, <span class="va">ampad_fc</span><span class="op">)</span> </span></code></pre>
</div>
<p>Take a look at the new table we just made:</p>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">head</span><span class="op">(</span><span class="va">ampad_modules_fc</span><span class="op">)</span></span></code></pre>
</div>
<p>We will use the data in <code>ampad_modules_fc</code> to compare with
log fold change data measured in mouse models.</p>
</div>
<div class="section level4">
<h4 id="preparing-module-information-for-correlation-plots">Preparing module information for correlation plots<a class="anchor" aria-label="anchor" href="#preparing-module-information-for-correlation-plots"></a></h4>
<p>Let’s package up these data and save this progress so far. This is
some manual book-keeping to arrange the modules into consensus clusters
for plotting later. You can just copy-paste this code into your
<code>Rstudio</code> session.</p>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cluster_a</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span></span>
<span>  module <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"TCXblue"</span>, <span class="st">"PHGyellow"</span>, <span class="st">"IFGyellow"</span><span class="op">)</span>,</span>
<span>  cluster <span class="op">=</span> <span class="st">"Consensus Cluster A (ECM organization)"</span>,</span>
<span>  cluster_label <span class="op">=</span> <span class="st">"Consensus Cluster A\n(ECM organization)"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">cluster_b</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span></span>
<span>  module <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"DLPFCblue"</span>, <span class="st">"CBEturquoise"</span>, <span class="st">"STGblue"</span>, <span class="st">"PHGturquoise"</span>, <span class="st">"IFGturquoise"</span>, <span class="st">"TCXturquoise"</span>, <span class="st">"FPturquoise"</span><span class="op">)</span>,</span>
<span>  cluster <span class="op">=</span> <span class="st">"Consensus Cluster B (Immune system)"</span>,</span>
<span>  cluster_label <span class="op">=</span> <span class="st">"Consensus Cluster B\n(Immune system)"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">cluster_c</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span></span>
<span>  module <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"IFGbrown"</span>, <span class="st">"STGbrown"</span>, <span class="st">"DLPFCyellow"</span>, <span class="st">"TCXgreen"</span>, <span class="st">"FPyellow"</span>, <span class="st">"CBEyellow"</span>, <span class="st">"PHGbrown"</span><span class="op">)</span>,</span>
<span>  cluster <span class="op">=</span> <span class="st">"Consensus Cluster C (Neuronal system)"</span>,</span>
<span>  cluster_label <span class="op">=</span> <span class="st">"Consensus Cluster C\n(Neuronal system)"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">cluster_d</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span></span>
<span>  module <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"DLPFCbrown"</span>, <span class="st">"STGyellow"</span>, <span class="st">"PHGgreen"</span>, <span class="st">"CBEbrown"</span>, <span class="st">"TCXyellow"</span>, <span class="st">"IFGblue"</span>, <span class="st">"FPblue"</span><span class="op">)</span>,</span>
<span>  cluster <span class="op">=</span> <span class="st">"Consensus Cluster D (Cell Cycle, NMD)"</span>,</span>
<span>  cluster_label <span class="op">=</span> <span class="st">"Consensus Cluster D\n(Cell Cycle, NMD)"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">cluster_e</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span></span>
<span>  module <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"FPbrown"</span>, <span class="st">"CBEblue"</span>, <span class="st">"DLPFCturquoise"</span>, <span class="st">"TCXbrown"</span>, <span class="st">"STGturquoise"</span>, <span class="st">"PHGblue"</span><span class="op">)</span>,</span>
<span>  cluster <span class="op">=</span> <span class="st">"Consensus Cluster E (Organelle Biogensis, Cellular stress response)"</span>,</span>
<span>  cluster_label <span class="op">=</span> <span class="st">"Consensus Cluster E\n(Organelle Biogenesis,\nCellular stress response)"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">module_clusters</span> <span class="op">&lt;-</span> <span class="va">cluster_a</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">bind_rows</span><span class="op">(</span><span class="va">cluster_b</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">bind_rows</span><span class="op">(</span><span class="va">cluster_c</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">bind_rows</span><span class="op">(</span><span class="va">cluster_d</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">bind_rows</span><span class="op">(</span><span class="va">cluster_e</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>cluster_label <span class="op">=</span> <span class="fu">fct_inorder</span><span class="op">(</span><span class="va">cluster_label</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">head</span><span class="op">(</span><span class="va">module_clusters</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="va">module_clusters</span><span class="op">$</span><span class="va">module</span></span>
<span></span>
<span><span class="fu">save</span><span class="op">(</span><span class="va">ampad_modules_fc</span>,<span class="va">module_clusters</span>,<span class="va">mod</span>,file<span class="op">=</span><span class="st">"../data/AMPAD_Module_Data.RData"</span><span class="op">)</span></span></code></pre>
</div>
</div>
</section><section><h2 class="section-heading" id="correlation-between-mouse-models-and-human-ad-modules">Correlation between mouse models and human AD modules<a class="anchor" aria-label="anchor" href="#correlation-between-mouse-models-and-human-ad-modules"></a></h2>
<hr class="half-width"><p>As demonstrated in the plots below, we’ll aim to identify modules
where the gene expression is correlated between human and mouse
orthologs (left) as well as modules where there is no correlation
(right).</p>
<figure><img src="fig/rmd04-hs_mm_logfc_correlation.png" alt="Human-mouse logFCcorrelation" class="figure mx-auto d-block"><div class="figcaption">Human-mouse logFCcorrelation</div>
</figure><p>There are two approaches that we commonly use to compute correlation
between mouse data and human AD data:</p>
<ol style="list-style-type: decimal"><li>Compare change in expression in Human AD cases vs controls with
change in expression in mouse models for each gene in a given
module:<br></li>
</ol><ul><li>LogFC(h) = log fold change in expression of human AD patients
compared to control patients.</li>
<li>LogFC(m) = log fold change in expression of mouse AD models compared
to control mouse models.</li>
</ul><p><span class="math display">\[cor.test(LogFC(h),
LogFC(m))\]</span></p>
<ol start="2" style="list-style-type: decimal"><li>Compare Human AD expression changes to mouse genetic effects for
each gene in a given module:<br></li>
</ol><ul><li>h = human gene expression (Log2 RNA-seq Fold Change AD/control)</li>
<li>β = mouse gene expression effect from linear regression model (Log2
RNA-seq TPM)</li>
</ul><p><span class="math display">\[cor.test(LogFC(h), β)\]</span></p>
<p>Both approaches allow us to assess directional coherence between gene
expression for genes in AMP-AD modules and the effects of genetic
manipulations in mice. For this lesson we are going to use the first
approach.</p>
<div class="section level4">
<h4 id="step-0-reading-gene-expression-count-matrix-from-previous-lesson">Step 0: Reading Gene Expression Count matrix from Previous
Lesson<a class="anchor" aria-label="anchor" href="#step-0-reading-gene-expression-count-matrix-from-previous-lesson"></a></h4>
<p>We’ll first read the result table saved after differential analysis
in last <a href="https://asliuyar.github.io/omicsTranslationAD/03-DESeq/index.html" class="external-link">lesson</a>.
We’ll start with the data from the 5xFAD mouse model to understand the
required steps to perform the correlation with human AD modules.</p>
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">load</span><span class="op">(</span><span class="st">"results/DEAnalysis_5XFAD.Rdata"</span><span class="op">)</span></span></code></pre>
</div>
<p>We can also load AMP-AD module data.</p>
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">load</span><span class="op">(</span><span class="st">"data/AMPAD_Module_Data.RData"</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="section level4">
<h4 id="step-1-measure-the-correlation-between-mouse-models-for-each-sex-at-each-age-and-amp-ad-modules-using-common-genes-from-both-datasets">Step 1: Measure the correlation between mouse models for each sex at
each age and AMP-AD modules using common genes from both datasets<a class="anchor" aria-label="anchor" href="#step-1-measure-the-correlation-between-mouse-models-for-each-sex-at-each-age-and-amp-ad-modules-using-common-genes-from-both-datasets"></a></h4>
<p>We compute a Pearson correlation between changes in expression for
each gene within a given module (log fold change for cases vs controls)
with each mouse model (log fold change of the 5xFAD mice vs sex- and
age-matched B6 mice).</p>
<p>First, we’ll combine both mouse <code>DE_5xFAD.df</code> and human
<code>ampad_modules_fc</code> log fold change data sets for all
genes.</p>
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_vs_ampad</span> <span class="op">&lt;-</span> <span class="fu">inner_join</span><span class="op">(</span><span class="va">DE_5xFAD.df</span>, <span class="va">ampad_modules_fc</span>, by <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"symbol"</span><span class="op">)</span>, multiple <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span> </span></code></pre>
</div>
<p><strong>Note:</strong> for this join we specify
<code>multiple = "all"</code> so that the same gene can be matched
across multiple human tissues.</p>
<div class="codewrapper sourceCode" id="cb29">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">head</span><span class="op">(</span><span class="va">model_vs_ampad</span><span class="op">)</span></span></code></pre>
</div>
<p>Now we’ll create a list column containing data frames using <a href="https://tidyr.tidyverse.org/reference/nest.html" class="external-link">tidyr::nest</a>
function. Nesting is implicitly a summarizing operation: you get one row
for each group defined by the non-nested columns.</p>
<div class="codewrapper sourceCode" id="cb30">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">model_vs_ampad</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">select</span><span class="op">(</span><span class="va">module</span>, <span class="va">model</span>, <span class="va">sex</span>, <span class="va">age</span>, <span class="va">symbol</span>, <span class="va">log2FoldChange</span>, <span class="va">ampad_fc</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">module</span>, <span class="va">model</span>, <span class="va">sex</span>, <span class="va">age</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">nest</span><span class="op">(</span>data <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="va">symbol</span>, <span class="va">log2FoldChange</span>, <span class="va">ampad_fc</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<p>Let’s take a look:</p>
<div class="codewrapper sourceCode" id="cb31">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">head</span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code></pre>
</div>
<p>And we can also look at some of the nested data:</p>
<div class="codewrapper sourceCode" id="cb32">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">head</span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">data</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre>
</div>
<p>These are the mouse and human log fold-change values for all genes in
the TCXblue module; the mouse data corresponds to 4 month old male 5xFAD
mice.</p>
<p>The total number of groups in the data table:</p>
<div class="codewrapper sourceCode" id="cb33">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">dim</span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code></pre>
</div>
<p>Next, we’ll compute correlation coefficients using the
<code>cor.test</code> function:</p>
<div class="codewrapper sourceCode" id="cb34">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cor.df</span> <span class="op">&lt;-</span> <span class="va">df</span>  <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>      cor_test <span class="op">=</span> <span class="fu">map</span><span class="op">(</span><span class="va">data</span>, <span class="op">~</span> <span class="fu">cor.test</span><span class="op">(</span><span class="va">.x</span><span class="op">[[</span><span class="st">"log2FoldChange"</span><span class="op">]</span><span class="op">]</span>, </span>
<span>                                      <span class="va">.x</span><span class="op">[[</span><span class="st">"ampad_fc"</span><span class="op">]</span><span class="op">]</span>, method <span class="op">=</span> <span class="st">"pearson"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      estimate <span class="op">=</span> <span class="fu">map_dbl</span><span class="op">(</span><span class="va">cor_test</span>, <span class="st">"estimate"</span><span class="op">)</span>,</span>
<span>      p_value <span class="op">=</span> <span class="fu">map_dbl</span><span class="op">(</span><span class="va">cor_test</span>, <span class="st">"p.value"</span><span class="op">)</span></span>
<span>      <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">cor_test</span><span class="op">)</span></span></code></pre>
</div>
<p>Here we’re using <code>purrr::map</code> based functions to apply the
correlation test to every entry in the <code>data</code> column. We can
pull out specific features from the <code>cor_test</code> list column,
including the computed correlation coefficient (<code>estimate</code>)
and the significance (<code>p.value</code>).</p>
<p>In the end we should have correlation coefficients and significance
values for every comparison in our data table:</p>
<div class="codewrapper sourceCode" id="cb35">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">head</span><span class="op">(</span><span class="va">cor.df</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="section level4">
<h4 id="step-2-annotate-correlation-table-to-prepare-for-visualization">Step 2: Annotate correlation table to prepare for visualization<a class="anchor" aria-label="anchor" href="#step-2-annotate-correlation-table-to-prepare-for-visualization"></a></h4>
<p>These steps will make it easier to make a nice looking plot during
the next step. We’ll add a column that flags whether the correlation is
significant or not, and we’ll add in the information about which
consensus cluster each module belongs to:</p>
<div class="codewrapper sourceCode" id="cb36">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_module</span> <span class="op">&lt;-</span> <span class="va">cor.df</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>significant <span class="op">=</span> <span class="va">p_value</span> <span class="op">&lt;</span> <span class="fl">0.05</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">left_join</span><span class="op">(</span><span class="va">module_clusters</span>, by <span class="op">=</span> <span class="st">"module"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">select</span><span class="op">(</span><span class="va">cluster</span>, <span class="va">cluster_label</span>, <span class="va">module</span>, <span class="va">model</span>, <span class="va">sex</span>, <span class="va">age</span>,</span>
<span>                correlation <span class="op">=</span> <span class="va">estimate</span>, <span class="va">p_value</span>, <span class="va">significant</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb37">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">head</span><span class="op">(</span><span class="va">model_module</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="section level4">
<h4 id="step-3-create-a-dataframe-to-use-as-input-for-plotting-the-results">Step 3: Create a dataframe to use as input for plotting the
results<a class="anchor" aria-label="anchor" href="#step-3-create-a-dataframe-to-use-as-input-for-plotting-the-results"></a></h4>
<p>More preparations for plotting, here we’ll get all of the values in
the right order so that they are grouped together nicely on the
plot.</p>
<div class="codewrapper sourceCode" id="cb38">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">order.model</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">"5xFAD (Male)"</span>, <span class="st">"5xFAD (Female)"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">correlation_for_plot</span> <span class="op">&lt;-</span> <span class="va">model_module</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">arrange</span><span class="op">(</span><span class="va">cluster</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">mutate</span><span class="op">(</span></span>
<span>      module <span class="op">=</span> <span class="fu">factor</span><span class="op">(</span><span class="va">module</span>,levels<span class="op">=</span><span class="va">mod</span><span class="op">)</span>,</span>
<span>      model_sex <span class="op">=</span> <span class="fu">glue</span><span class="fu">::</span><span class="fu">glue</span><span class="op">(</span><span class="st">"{model} ({str_to_title(sex)})"</span><span class="op">)</span>,</span>
<span>    <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">arrange</span><span class="op">(</span><span class="va">model_sex</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">mutate</span><span class="op">(</span></span>
<span>      age <span class="op">=</span> <span class="fu">factor</span><span class="op">(</span><span class="va">age</span>, levels <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">'4 mo'</span>,<span class="st">'6 mo'</span>, <span class="st">'12 mo'</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      model_sex <span class="op">=</span> <span class="fu">factor</span><span class="op">(</span><span class="va">model_sex</span>,levels<span class="op">=</span><span class="va">order.model</span><span class="op">)</span>,</span>
<span>      model_sex <span class="op">=</span> <span class="fu">fct_rev</span><span class="op">(</span><span class="va">model_sex</span><span class="op">)</span>,</span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="fu">head</span><span class="op">(</span><span class="va">correlation_for_plot</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="visualizing-the-correlation-plot">Visualizing the Correlation plot<a class="anchor" aria-label="anchor" href="#visualizing-the-correlation-plot"></a></h3>
<p>Now, we will use the above matrix and visualize the correlation
results using <code>ggplot2</code> package functions.</p>
<div class="codewrapper sourceCode" id="cb39">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">correlation_for_plot</span></span>
<span><span class="fu">range</span><span class="op">(</span><span class="va">correlation_for_plot</span><span class="op">$</span><span class="va">correlation</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  </span>
<span>  <span class="co"># the AMP-AD modules will be along the x-axis, the mouse models will be along the y-axis</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu">geom_tile</span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">.data</span><span class="op">$</span><span class="va">module</span>, y <span class="op">=</span> <span class="va">.data</span><span class="op">$</span><span class="va">model_sex</span><span class="op">)</span>, colour <span class="op">=</span> <span class="st">"black"</span>, fill <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  </span>
<span>  <span class="co"># each tile of the grid will be filled with a circle where the fill and size correspond to the correlation coefficient</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu">geom_point</span><span class="op">(</span>data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">filter</span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">.data</span><span class="op">$</span><span class="va">module</span>, y <span class="op">=</span> <span class="va">.data</span><span class="op">$</span><span class="va">model_sex</span>, colour <span class="op">=</span> <span class="va">.data</span><span class="op">$</span><span class="va">correlation</span>, size <span class="op">=</span> <span class="fu">abs</span><span class="op">(</span><span class="va">.data</span><span class="op">$</span><span class="va">correlation</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  </span>
<span>  <span class="co"># we'll draw a box arround significant correlations</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu">geom_point</span><span class="op">(</span>data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">filter</span><span class="op">(</span><span class="va">data</span>, <span class="va">.data</span><span class="op">$</span><span class="va">significant</span><span class="op">)</span>, <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">.data</span><span class="op">$</span><span class="va">module</span>, y <span class="op">=</span> <span class="va">.data</span><span class="op">$</span><span class="va">model_sex</span>, colour <span class="op">=</span> <span class="va">.data</span><span class="op">$</span><span class="va">correlation</span><span class="op">)</span>,color<span class="op">=</span><span class="st">"black"</span>,shape<span class="op">=</span><span class="fl">0</span>,size<span class="op">=</span><span class="fl">9</span><span class="op">)</span> <span class="op">+</span></span>
<span>  </span>
<span>  <span class="co"># plot the x-axis on the top of the plot, set the parameters of the scales</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu">scale_x_discrete</span><span class="op">(</span>position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu">scale_size</span><span class="op">(</span>guide <span class="op">=</span> <span class="st">"none"</span>, limits <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.4</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu">scale_color_gradient2</span><span class="op">(</span>limits <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span><span class="op">)</span>, low <span class="op">=</span> <span class="st">"#85070C"</span>, high <span class="op">=</span> <span class="st">"#164B6E"</span>, name <span class="op">=</span> <span class="st">"Correlation"</span>, guide <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu">guide_colorbar</span><span class="op">(</span>ticks <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  </span>
<span>  <span class="co"># remove axis labels</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="cn">NULL</span>, y <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span></span>
<span>  </span>
<span>  <span class="co"># facet the plot based on age range for the mice (rows) and consensus cluster (columns)</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu">facet_grid</span><span class="op">(</span> rows <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">vars</span><span class="op">(</span><span class="va">.data</span><span class="op">$</span><span class="va">age</span><span class="op">)</span>,cols <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">vars</span><span class="op">(</span><span class="va">.data</span><span class="op">$</span><span class="va">cluster_label</span><span class="op">)</span>, scales <span class="op">=</span> <span class="st">"free"</span>, space <span class="op">=</span> <span class="st">"free"</span>,switch <span class="op">=</span> <span class="st">'y'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  </span>
<span>  <span class="co"># specify how different aspects of the plot will look</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu">theme</span><span class="op">(</span></span>
<span>    strip.text.x <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span>,colour <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"black"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    strip.text.y.left <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">0</span>,size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,</span>
<span>    axis.ticks <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    axis.text.x <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, hjust <span class="op">=</span> <span class="fl">0</span>, size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,</span>
<span>    axis.text.y <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">0</span>, size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,</span>
<span>    panel.background <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    plot.title <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">0</span>, vjust <span class="op">=</span> <span class="op">-</span><span class="fl">54</span>, hjust <span class="op">=</span> <span class="fl">0.03</span>,size<span class="op">=</span><span class="fl">12</span>,face<span class="op">=</span><span class="st">"bold"</span><span class="op">)</span>,</span>
<span>    plot.title.position <span class="op">=</span> <span class="st">"plot"</span>,</span>
<span>    panel.grid <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="st">"right"</span></span>
<span>  <span class="op">)</span></span></code></pre>
</div>
<figure><img src="results/AMPAD1.png" alt="AMPAD - 5XFAD correlation plot" class="figure mx-auto d-block"><div class="figcaption">AMPAD - 5XFAD correlation plot</div>
</figure><p>In the above plot, categories along the x-axis are the 30 AMP-AD
co-expression modules grouped into 5 consensus clusters, while the
categories along the y-axis show the different groupings of mouse models
tested (split by age and sex). Positive correlations are shown in blue
and negative correlations in red. Color intensity and size of the
circles are proportional to the correlation coefficient. Black squares
around dots represent significant correlation at p-value=0.05 and
non-significant correlations are left blank.</p>
<p>Male and female 5xFAD mice display gene expression alterations across
all five consensus clusters, with the strongest correlations observed
among modules/genes in Consensus Cluster B, which generally consists of
immune system pathways and functions.</p>
</div>
<div class="section level3">
<h3 id="examining-individual-correlation-results">Examining individual correlation results<a class="anchor" aria-label="anchor" href="#examining-individual-correlation-results"></a></h3>
<p>Let’s say we want to know more about a single comparison in the plot
above and which genes are contributing to the correlation result. Maybe
we’re really interested in the correlations to the FPbrown module
between female 5xFAD mice at 4 months and 6 months. We can plot the
individual correlations for each comparison in the plot above with the
data we have. We’ll label genes with large fold change in the mouse
using the <code>ggrepel::geom_label_repel</code> function.</p>
<div class="codewrapper sourceCode" id="cb40">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># specify which comparisons to consider</span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="st">'FPbrown'</span></span>
<span><span class="va">s</span> <span class="op">&lt;-</span> <span class="st">'female'</span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">'4 mo'</span>,<span class="st">'6 mo'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># filter the correlation data frame to these comparisons</span></span>
<span><span class="va">indiv.corr</span> <span class="op">&lt;-</span> <span class="va">cor.df</span> <span class="op">%&gt;%</span> <span class="fu">filter</span><span class="op">(</span><span class="va">module</span> <span class="op">==</span> <span class="va">m</span>, <span class="va">sex</span> <span class="op">==</span> <span class="va">s</span>, <span class="va">age</span> <span class="op">%in%</span> <span class="va">a</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">unnest</span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span> facet <span class="op">=</span> <span class="fu">str_c</span><span class="op">(</span><span class="va">age</span>, <span class="st">'\n'</span>, <span class="st">'r = '</span>,<span class="fu">signif</span><span class="op">(</span><span class="va">estimate</span>,<span class="fl">3</span><span class="op">)</span>,<span class="st">' ; p = '</span>,<span class="fu">signif</span><span class="op">(</span><span class="va">p_value</span>,<span class="fl">3</span><span class="op">)</span> <span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">indiv.corr</span>, <span class="fu">aes</span><span class="op">(</span> <span class="va">log2FoldChange</span> , <span class="va">ampad_fc</span> <span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span>, lwd <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, lwd <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span> size <span class="op">=</span> <span class="fl">.5</span>, color <span class="op">=</span> <span class="st">'darkred'</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_smooth</span><span class="op">(</span>method <span class="op">=</span> <span class="st">'lm'</span>, lwd <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">ggrepel</span><span class="fu">::</span><span class="fu">geom_label_repel</span><span class="op">(</span> data <span class="op">=</span> <span class="fu">arrange</span><span class="op">(</span><span class="va">indiv.corr</span>, <span class="fu">desc</span><span class="op">(</span><span class="fu">abs</span><span class="op">(</span><span class="va">log2FoldChange</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                             <span class="fu">aes</span><span class="op">(</span>label <span class="op">=</span> <span class="va">symbol</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">2</span> <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">'5xFAD logFC'</span>, y <span class="op">=</span> <span class="st">'AMP-AD logFC'</span>,</span>
<span>       title <span class="op">=</span> <span class="fu">unique</span><span class="op">(</span><span class="va">indiv.corr</span><span class="op">$</span><span class="va">module</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">facet</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="results/AMPAD_FPbrown.png" alt="AMPAD - 5XFAD FPbrown correlation" class="figure mx-auto d-block"><div class="figcaption">AMPAD - 5XFAD FPbrown correlation</div>
</figure><p>Here we can see that the 5xFAD logFC are pretty small in general. The
correlations are relatively weak and driven by individual genes that
have relatively large changes (e.g. Heatr4, Nirp1a, Rpl39l). If we
compare a different module, say STGblue, we can see a stronger
relationship between the mouse and human expression.</p>
<div class="codewrapper sourceCode" id="cb41">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="st">'STGblue'</span></span>
<span><span class="va">s</span> <span class="op">&lt;-</span> <span class="st">'female'</span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">'4 mo'</span>,<span class="st">'12 mo'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">indiv.corr</span> <span class="op">&lt;-</span> <span class="va">cor.df</span> <span class="op">%&gt;%</span> <span class="fu">filter</span><span class="op">(</span><span class="va">module</span> <span class="op">==</span> <span class="va">m</span>, <span class="va">sex</span> <span class="op">==</span> <span class="va">s</span>, <span class="va">age</span> <span class="op">%in%</span> <span class="va">a</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">unnest</span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span> v <span class="op">=</span> <span class="fu">str_c</span><span class="op">(</span><span class="va">age</span>, <span class="st">'\n'</span>, <span class="st">'r = '</span>,<span class="fu">signif</span><span class="op">(</span><span class="va">estimate</span>,<span class="fl">3</span><span class="op">)</span>,<span class="st">' ; p = '</span>,<span class="fu">signif</span><span class="op">(</span><span class="va">p_value</span>,<span class="fl">3</span><span class="op">)</span> <span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">indiv.corr</span>, <span class="fu">aes</span><span class="op">(</span> <span class="va">log2FoldChange</span> , <span class="va">ampad_fc</span> <span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span>, lwd <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, lwd <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span> size <span class="op">=</span> <span class="fl">.5</span>, color <span class="op">=</span> <span class="st">'darkred'</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_smooth</span><span class="op">(</span>method <span class="op">=</span> <span class="st">'lm'</span>, lwd <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">ggrepel</span><span class="fu">::</span><span class="fu">geom_label_repel</span><span class="op">(</span> data <span class="op">=</span> <span class="fu">arrange</span><span class="op">(</span><span class="va">indiv.corr</span>, <span class="fu">desc</span><span class="op">(</span><span class="fu">abs</span><span class="op">(</span><span class="va">log2FoldChange</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                             <span class="fu">aes</span><span class="op">(</span>label <span class="op">=</span> <span class="va">symbol</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">2</span> <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">'5xFAD logFC'</span>, y <span class="op">=</span> <span class="st">'AMP-AD logFC'</span>,</span>
<span>       title <span class="op">=</span> <span class="fu">unique</span><span class="op">(</span><span class="va">indiv.corr</span><span class="op">$</span><span class="va">module</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">v</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="results/AMPAD_STGblue.png" alt="AMPAD - 5XFAD STGblue correlation" class="figure mx-auto d-block"><div class="figcaption">AMPAD - 5XFAD STGblue correlation</div>
</figure><p>These correlations are much stronger (r ~ 0.3 vs 0.1 in the previous
example), and there is a consistent pattern between young mice and old
mice, with similar genes being expressed in similar ways (e.g. Itgax and
Clec7a are up-regulated at both ages). We also saw in the Volcano plot
that immune-related genes were significantly up-regulated in the 5xFAD
model. These significant positive correlation suggests that the 5xFAD
model captures inflammatory changes observed in human AD patients.</p>
<div id="challenge-3" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-3" class="callout-inner">
<h3 class="callout-title">Challenge 3</h3>
<div class="callout-content">
<p>Considering the LOAD1 (i.e. APOE4.Trem2) model results, which modules
show correlation and how does it compare with 5xFAD?</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" data-bs-parent="#accordionSolution3" aria-labelledby="headingSolution3">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb42">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="fu">load</span><span class="op">(</span><span class="st">"../results/DEAnalysis_LOAD1.Rdata"</span><span class="op">)</span></span>
<span> <span class="va">model_vs_ampad</span> <span class="op">&lt;-</span> <span class="fu">inner_join</span><span class="op">(</span><span class="va">DE_LOAD1.df</span>, <span class="va">ampad_modules_fc</span>, by <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"symbol"</span><span class="op">)</span>, multiple <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span> </span>
<span> <span class="va">cor.df</span> <span class="op">&lt;-</span> <span class="va">model_vs_ampad</span> <span class="op">%&gt;%</span></span>
<span>   <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">select</span><span class="op">(</span><span class="va">module</span>, <span class="va">model</span>, <span class="va">sex</span>, <span class="va">age</span>, <span class="va">symbol</span>, <span class="va">log2FoldChange</span>, <span class="va">ampad_fc</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>   <span class="fu">group_by</span><span class="op">(</span><span class="va">module</span>, <span class="va">model</span>, <span class="va">sex</span>, <span class="va">age</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>   <span class="fu">nest</span><span class="op">(</span>data <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="va">symbol</span>, <span class="va">log2FoldChange</span>, <span class="va">ampad_fc</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>   <span class="fu">mutate</span><span class="op">(</span></span>
<span>       cor_test <span class="op">=</span> <span class="fu">map</span><span class="op">(</span><span class="va">data</span>, <span class="op">~</span> <span class="fu">cor.test</span><span class="op">(</span><span class="va">.x</span><span class="op">[[</span><span class="st">"log2FoldChange"</span><span class="op">]</span><span class="op">]</span>, </span>
<span>                                       <span class="va">.x</span><span class="op">[[</span><span class="st">"ampad_fc"</span><span class="op">]</span><span class="op">]</span>, method <span class="op">=</span> <span class="st">"pearson"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>       estimate <span class="op">=</span> <span class="fu">map_dbl</span><span class="op">(</span><span class="va">cor_test</span>, <span class="st">"estimate"</span><span class="op">)</span>,</span>
<span>       p_value <span class="op">=</span> <span class="fu">map_dbl</span><span class="op">(</span><span class="va">cor_test</span>, <span class="st">"p.value"</span><span class="op">)</span></span>
<span>       <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>   <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>   <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">cor_test</span><span class="op">)</span></span>
<span> <span class="va">model_module</span> <span class="op">&lt;-</span> <span class="va">cor.df</span> <span class="op">%&gt;%</span></span>
<span>     <span class="fu">mutate</span><span class="op">(</span>significant <span class="op">=</span> <span class="va">p_value</span> <span class="op">&lt;</span> <span class="fl">0.05</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>     <span class="fu">left_join</span><span class="op">(</span><span class="va">module_clusters</span>, by <span class="op">=</span> <span class="st">"module"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>     <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">select</span><span class="op">(</span><span class="va">cluster</span>, <span class="va">cluster_label</span>, <span class="va">module</span>, <span class="va">model</span>, <span class="va">sex</span>, <span class="va">age</span>,</span>
<span>                   correlation <span class="op">=</span> <span class="va">estimate</span>, <span class="va">p_value</span>, <span class="va">significant</span><span class="op">)</span></span>
<span> <span class="va">order.model</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">"APOE4 (Male)"</span>, <span class="st">"APOE4 (Female)"</span>,<span class="st">"Trem2 (Male)"</span>, <span class="st">"Trem2 (Female)"</span>,<span class="st">"APOE4Trem2 (Male)"</span>, <span class="st">"APOE4Trem2 (Female)"</span><span class="op">)</span></span>
<span> <span class="va">correlation_for_plot</span> <span class="op">&lt;-</span> <span class="va">model_module</span> <span class="op">%&gt;%</span></span>
<span>     <span class="fu">arrange</span><span class="op">(</span><span class="va">cluster</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>     <span class="fu">mutate</span><span class="op">(</span></span>
<span>       module <span class="op">=</span> <span class="fu">factor</span><span class="op">(</span><span class="va">module</span>,levels<span class="op">=</span><span class="va">mod</span><span class="op">)</span>,</span>
<span>       model_sex <span class="op">=</span> <span class="fu">glue</span><span class="fu">::</span><span class="fu">glue</span><span class="op">(</span><span class="st">"{model} ({str_to_title(sex)})"</span><span class="op">)</span>,</span>
<span>    <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>     <span class="fu">arrange</span><span class="op">(</span><span class="va">model_sex</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>     <span class="fu">mutate</span><span class="op">(</span></span>
<span>       age <span class="op">=</span> <span class="fu">factor</span><span class="op">(</span><span class="va">age</span>, levels <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">4</span>,<span class="fl">8</span><span class="op">)</span><span class="op">)</span>,</span>
<span>       model_sex <span class="op">=</span> <span class="fu">factor</span><span class="op">(</span><span class="va">model_sex</span>,levels<span class="op">=</span><span class="va">order.model</span><span class="op">)</span>,</span>
<span>       model_sex <span class="op">=</span> <span class="fu">fct_rev</span><span class="op">(</span><span class="va">model_sex</span><span class="op">)</span>,</span>
<span>     <span class="op">)</span></span>
<span> <span class="va">data</span> <span class="op">&lt;-</span> <span class="va">correlation_for_plot</span></span>
<span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu">geom_tile</span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">.data</span><span class="op">$</span><span class="va">module</span>, y <span class="op">=</span> <span class="va">.data</span><span class="op">$</span><span class="va">model_sex</span><span class="op">)</span>, colour <span class="op">=</span> <span class="st">"black"</span>, fill <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu">geom_point</span><span class="op">(</span>data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">filter</span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">.data</span><span class="op">$</span><span class="va">module</span>, y <span class="op">=</span> <span class="va">.data</span><span class="op">$</span><span class="va">model_sex</span>, colour <span class="op">=</span>  <span class="va">.data</span><span class="op">$</span><span class="va">correlation</span>, size <span class="op">=</span> <span class="fu">abs</span><span class="op">(</span><span class="va">.data</span><span class="op">$</span><span class="va">correlation</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu">geom_point</span><span class="op">(</span>data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">filter</span><span class="op">(</span><span class="va">data</span>, <span class="va">.data</span><span class="op">$</span><span class="va">significant</span><span class="op">)</span>, <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">.data</span><span class="op">$</span><span class="va">module</span>, y <span class="op">=</span> <span class="va">.data</span><span class="op">$</span><span class="va">model_sex</span>, colour <span class="op">=</span> <span class="va">.data</span><span class="op">$</span><span class="va">correlation</span><span class="op">)</span>,color<span class="op">=</span><span class="st">"black"</span>,shape<span class="op">=</span><span class="fl">0</span>,size<span class="op">=</span><span class="fl">9</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu">scale_x_discrete</span><span class="op">(</span>position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu">scale_size</span><span class="op">(</span>guide <span class="op">=</span> <span class="st">"none"</span>, limits <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.4</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu">scale_color_gradient2</span><span class="op">(</span>limits <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span><span class="op">)</span>, low <span class="op">=</span> <span class="st">"#85070C"</span>, high <span class="op">=</span> <span class="st">"#164B6E"</span>, name <span class="op">=</span> <span class="st">"Correlation"</span>, guide <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu">guide_colorbar</span><span class="op">(</span>ticks <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="cn">NULL</span>, y <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu">facet_grid</span><span class="op">(</span> rows <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">vars</span><span class="op">(</span><span class="va">.data</span><span class="op">$</span><span class="va">age</span><span class="op">)</span>,cols <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">vars</span><span class="op">(</span><span class="va">.data</span><span class="op">$</span><span class="va">cluster_label</span><span class="op">)</span>, scales <span class="op">=</span> <span class="st">"free"</span>, space <span class="op">=</span> <span class="st">"free"</span>,switch <span class="op">=</span> <span class="st">'y'</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu">theme</span><span class="op">(</span></span>
<span>     strip.text.x <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span>,colour <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"black"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>     strip.text.y.left <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">0</span>,size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,</span>
<span>     axis.ticks <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>     axis.text.x <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, hjust <span class="op">=</span> <span class="fl">0</span>, size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,</span>
<span>     axis.text.y <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">0</span>, size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,</span>
<span>     panel.background <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>     plot.title <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">0</span>, vjust <span class="op">=</span> <span class="op">-</span><span class="fl">54</span>, hjust <span class="op">=</span> <span class="fl">0.03</span>,size<span class="op">=</span><span class="fl">12</span>,face<span class="op">=</span><span class="st">"bold"</span><span class="op">)</span>,</span>
<span>     plot.title.position <span class="op">=</span> <span class="st">"plot"</span>,</span>
<span>     panel.grid <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>     legend.position <span class="op">=</span> <span class="st">"right"</span></span>
<span>   <span class="op">)</span></span></code></pre>
</div>
<p>The LOAD1 models show weaker correlation to AMP-AD module gene
expression overall, and in particular anti-correlation for Consensus
Cluster B (immune) modules.</p>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="detecting-functional-coherence-of-gene-sets-from-omics-data">Detecting functional coherence of gene sets from omics data<a class="anchor" aria-label="anchor" href="#detecting-functional-coherence-of-gene-sets-from-omics-data"></a></h2>
<hr class="half-width"><p>Most omics analyses produce data on many thousands of genomic
features (i.e.  transcripts, proteins, etc.) for each condition tested.
Simply looking at these lists of genes and associated statistics can be
daunting and uninformative. We need approaches to identify which
biological functions are being impacted by a given experiment from these
systems-level measurements.</p>
<p>Gene functional enrichment analysis describes a variety of
statistical methods that identify groups of genes that share a
particular biological function or process and show differential
association with experimental conditions. Most approaches compare some
statistically valid set of differentially expressed features to sets of
functional annotations for those features. There are many different
functional annotation sets available, some of the more commonly used
include:</p>
<ul><li>gene function resources, such as the <a href="amigo.geneontology.org/amigo">Gene Ontology</a> (i.e. GO)<br></li>
<li>pathway databases, such as <a href="reactome.org">Reactome</a> or <a href="www.genome.jp/kegg/">KEGG</a><br></li>
<li>disease and phenotype ontologies, such as the <a href="hpo.jax.org/app">Human Phenotype Ontology</a>, the <a href="www.informatics.jax.org/vocab/mp_ontology">Mammalian Phenotype
Ontology</a>, and the <a href="https://disease-ontology.org/" class="external-link">Disease
Ontology</a>
</li>
</ul><p>These are the resources that are the foundation for many genomics
knowledge bases, such as <a href="www.informatics.jax.org">MGI</a>, <a href="monarchinitiative.org">monarch initiative</a>, and the <a href="alliancegenome.org">Alliance of Genome Resources</a>. The precise
nature of each of these resources varies, but the core information
contained within each is the relationship of sets of genes to
biologically meaningful annotations. These annotations are typically
expertly curated from the published literature.</p>
<p>There are a variety of statistical approaches that can be employed to
test for functional enrichment among genes identified from an omics
dataset. Two of the most common broad classes of tests are
<em>over-representation analysis (ORA)</em> and <em>gene set enrichment
analysis (GSEA)</em>. For example, consider the figure below from <a href="https://doi.org/10.1016/j.tig.2023.01.003" class="external-link">Zhao &amp; Rhee, Trends
in Genetics (2023)</a>. Let’s consider each in a bit more detail.</p>
<figure><img src="fig/rmd04-Zhao_Rhee_TrendsGenetics_pathway_enrichment.jpg" alt="Functional enrichment approaches" class="figure mx-auto d-block"><div class="figcaption">Functional enrichment approaches</div>
</figure><div class="section level3">
<h3 id="over-representation-analysis">Over-representation analysis<a class="anchor" aria-label="anchor" href="#over-representation-analysis"></a></h3>
<p><code>ORA</code> involves statistical tests of overlap between two
lists of genes: one derived from the experiment and one from the
functional annotations. For example, one might ask what is the overlap
between the genes in an annotation class, such as “Lysosome”, and the
genes that are significantly up-regulated in a given experimental
condition. These tests usually rely on some form of Fisher’s exact test
(e.g. <code>fisher.test()</code>) or hypergeometric test (e.g. 
<code>phyper()</code>). If the gene lists consist of a larger number of
overlapping genes than would be expected at random - given the sample
sizes involved - then there is said to be a statistical
over-representation of the annotation class within the experimental
condition.</p>
<p>Of course, these overlap tests are generally considered for all
annotation classes, which can number in the hundreds to thousands.
Performing this many statistical tests ensures that many will be
identified as significant by chance. Therefore, there is typically a
requirement to correct for multiple testing errors
(e.g. <code>p.adjust()</code>).</p>
<p>There are many R packages available to handle the statistical tests
and corrections involved in ORA. Today we’ll use
<code>clusterProfiler::enrichGO()</code>, which wraps statistical
testing for overlap with GO terms and multiple test correction in one
function.</p>
<p>Let’s start by considering the enrichments from the mouse data
analyzed previously.</p>
<div class="codewrapper sourceCode" id="cb43">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">theme_set</span><span class="op">(</span><span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">load</span><span class="op">(</span><span class="st">'results/DEAnalysis_5XFAD.RData'</span><span class="op">)</span></span></code></pre>
</div>
<p>We’ll start by considering the genes that are significantly DE in 12
month old male animals</p>
<div class="codewrapper sourceCode" id="cb44">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gene.list.up</span> <span class="op">&lt;-</span> <span class="va">DE_5xFAD.df</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">sex</span> <span class="op">==</span> <span class="st">'male'</span>, </span>
<span>         <span class="va">age</span> <span class="op">==</span> <span class="st">'12 mo'</span>,</span>
<span>         <span class="va">padj</span> <span class="op">&lt;=</span> <span class="fl">0.05</span>, </span>
<span>         <span class="va">log2FoldChange</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">arrange</span><span class="op">(</span><span class="fu">desc</span><span class="op">(</span><span class="va">log2FoldChange</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="op">!</span><span class="fu">duplicated</span><span class="op">(</span><span class="va">symbol</span><span class="op">)</span>, <span class="op">!</span><span class="fu">is.na</span><span class="op">(</span><span class="va">symbol</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">pull</span><span class="op">(</span><span class="va">symbol</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">unique</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gene.list.dn</span> <span class="op">&lt;-</span> <span class="va">DE_5xFAD.df</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">sex</span> <span class="op">==</span> <span class="st">'male'</span>, </span>
<span>         <span class="va">age</span> <span class="op">==</span> <span class="st">'12 mo'</span>,</span>
<span>         <span class="va">padj</span> <span class="op">&lt;=</span> <span class="fl">0.05</span>, </span>
<span>         <span class="va">log2FoldChange</span> <span class="op">&lt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">arrange</span><span class="op">(</span><span class="fu">desc</span><span class="op">(</span><span class="va">log2FoldChange</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="op">!</span><span class="fu">duplicated</span><span class="op">(</span><span class="va">symbol</span><span class="op">)</span>, <span class="op">!</span><span class="fu">is.na</span><span class="op">(</span><span class="va">symbol</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">pull</span><span class="op">(</span><span class="va">symbol</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">unique</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">length</span><span class="op">(</span><span class="va">gene.list.up</span><span class="op">)</span></span>
<span><span class="fu">length</span><span class="op">(</span><span class="va">gene.list.dn</span><span class="op">)</span></span></code></pre>
</div>
<p>There are a total of significantly up-regulated genes and
significantly down-regulated genes in this cohort. Now test for over
representation of GO terms among the DEGs. First, we need to identify
the universe of all possible genes which includes the genes that were
both measured by the experiment and contained within the annotation
set.</p>
<div class="codewrapper sourceCode" id="cb45">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">univ</span> <span class="op">&lt;-</span> <span class="fu">as.data.frame</span><span class="op">(</span><span class="va">org.Mm.egGO</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">pull</span><span class="op">(</span><span class="va">gene_id</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">unique</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">bitr</span><span class="op">(</span><span class="va">.</span>, fromType <span class="op">=</span> <span class="st">"ENTREZID"</span>, toType <span class="op">=</span> <span class="st">'SYMBOL'</span>, OrgDb <span class="op">=</span> <span class="va">org.Mm.eg.db</span>, drop <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">pull</span><span class="op">(</span><span class="st">'SYMBOL'</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">intersect</span><span class="op">(</span><span class="va">.</span>, <span class="va">DE_5xFAD.df</span><span class="op">$</span><span class="va">symbol</span><span class="op">)</span></span></code></pre>
</div>
<p>Now let’s test for enriched GO terms (this can take 3-4 minutes)</p>
<div class="codewrapper sourceCode" id="cb46">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">enr.up</span> <span class="op">&lt;-</span> <span class="fu">enrichGO</span><span class="op">(</span><span class="va">gene.list.up</span>, </span>
<span>                   ont <span class="op">=</span> <span class="st">'all'</span>, </span>
<span>                   OrgDb <span class="op">=</span> <span class="va">org.Mm.eg.db</span>, </span>
<span>                   keyType <span class="op">=</span> <span class="st">'SYMBOL'</span>,</span>
<span>                   universe <span class="op">=</span> <span class="va">univ</span></span>
<span>                   <span class="op">)</span></span>
<span><span class="va">enr.dn</span> <span class="op">&lt;-</span> <span class="fu">enrichGO</span><span class="op">(</span><span class="va">gene.list.dn</span>, </span>
<span>                   ont <span class="op">=</span> <span class="st">'all'</span>, </span>
<span>                   OrgDb <span class="op">=</span> <span class="va">org.Mm.eg.db</span>, </span>
<span>                   keyType <span class="op">=</span> <span class="st">'SYMBOL'</span>,</span>
<span>                   universe <span class="op">=</span> <span class="va">univ</span></span>
<span>                   <span class="op">)</span></span></code></pre>
</div>
<p>How many significant terms are identified:</p>
<div class="codewrapper sourceCode" id="cb47">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">enr.up</span><span class="op">@</span><span class="va">result</span> <span class="op">%&gt;%</span> <span class="fu">filter</span><span class="op">(</span><span class="va">p.adjust</span> <span class="op">&lt;=</span> <span class="fl">0.05</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">pull</span><span class="op">(</span><span class="va">ID</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">unique</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">length</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">enr.dn</span><span class="op">@</span><span class="va">result</span> <span class="op">%&gt;%</span> <span class="fu">filter</span><span class="op">(</span><span class="va">p.adjust</span> <span class="op">&lt;=</span> <span class="fl">0.05</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">pull</span><span class="op">(</span><span class="va">ID</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">unique</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">length</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div id="challenge-4" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-4" class="callout-inner">
<h3 class="callout-title">Challenge 4</h3>
<div class="callout-content">
<p>How many significant terms are identified from the up-regulated gene
list if you do not specify the “universe”?</p>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4"> Show me the solution </h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" data-bs-parent="#accordionSolution4" aria-labelledby="headingSolution4">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb48">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="fu">enrichGO</span><span class="op">(</span><span class="va">gene.list.up</span>, ont <span class="op">=</span> <span class="st">'all'</span>, OrgDb <span class="op">=</span> <span class="va">org.Mm.eg.db</span>, keyType <span class="op">=</span> <span class="st">'SYMBOL'</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>   <span class="va">.</span><span class="op">@</span><span class="va">result</span> <span class="op">%&gt;%</span> <span class="fu">filter</span><span class="op">(</span><span class="va">p.adjust</span> <span class="op">&lt;=</span> <span class="fl">0.05</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">pull</span><span class="op">(</span><span class="va">ID</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">unique</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">length</span><span class="op">(</span><span class="op">)</span>  </span></code></pre>
</div>
</div>
</div>
</div>
</div>
<p>Plot the top 10 significant terms:</p>
<div class="codewrapper sourceCode" id="cb49">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">cowplot</span><span class="fu">::</span><span class="fu">plot_grid</span><span class="op">(</span></span>
<span>  <span class="fu">dotplot</span><span class="op">(</span><span class="va">enr.dn</span>, showCategory <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggtitle</span><span class="op">(</span><span class="st">'down'</span><span class="op">)</span>,</span>
<span>  <span class="fu">dotplot</span><span class="op">(</span><span class="va">enr.up</span>, showCategory <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggtitle</span><span class="op">(</span><span class="st">'up'</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="results/significantTerms.png" alt="significantTerms" class="figure mx-auto d-block"><div class="figcaption">significantTerms</div>
</figure><p>From this we can see that nervous system related terms
(e.g. “learning or memory”, “neurotransmitter transport”) are down in
5xFAD males at 12 months, while immune functions
(e.g. “cytokine-mediated signaling pathway” and “leukocyte mediated
immunity”) are up in 5xFAD males at 12 months.</p>
</div>
<div class="section level3">
<h3 id="gene-set-enrichment-analysis">Gene set enrichment analysis<a class="anchor" aria-label="anchor" href="#gene-set-enrichment-analysis"></a></h3>
<p><code>GSEA</code> is an alternative approach that uses a statistical
measure from the omics data (e.g. the log fold change or significance)
to rank the genes. An “enrichment score” is calculated for each
annotation set based on where the genes annotated to the term sit in the
overall distribution.</p>
<p>Let’s analyze those same data with the
<code>clusterProfiler::gseGO()</code> function. First we’ll specify the
gene list and use the <code>log2FoldChange</code> value to rank the
genes in the list.</p>
<div class="codewrapper sourceCode" id="cb50">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gene.list</span> <span class="op">&lt;-</span> <span class="va">DE_5xFAD.df</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">sex</span> <span class="op">==</span> <span class="st">'male'</span>, </span>
<span>         <span class="va">age</span> <span class="op">==</span> <span class="st">'12 mo'</span>,</span>
<span>         <span class="va">padj</span> <span class="op">&lt;=</span> <span class="fl">0.05</span></span>
<span>         <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">arrange</span><span class="op">(</span><span class="fu">desc</span><span class="op">(</span><span class="va">log2FoldChange</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="op">!</span><span class="fu">duplicated</span><span class="op">(</span><span class="va">symbol</span><span class="op">)</span>, <span class="op">!</span><span class="fu">is.na</span><span class="op">(</span><span class="va">symbol</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">pull</span><span class="op">(</span><span class="va">log2FoldChange</span>, name <span class="op">=</span> <span class="va">symbol</span><span class="op">)</span></span></code></pre>
</div>
<p>Now we’ll test for enrichment:</p>
<div class="codewrapper sourceCode" id="cb51">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">enr</span> <span class="op">&lt;-</span> <span class="fu">gseGO</span><span class="op">(</span><span class="va">gene.list</span>, ont <span class="op">=</span> <span class="st">'all'</span>, OrgDb <span class="op">=</span> <span class="va">org.Mm.eg.db</span>, keyType <span class="op">=</span> <span class="st">'SYMBOL'</span><span class="op">)</span></span></code></pre>
</div>
<p>How many significant terms are identified:</p>
<div class="codewrapper sourceCode" id="cb52">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">enr</span><span class="op">@</span><span class="va">result</span> <span class="op">%&gt;%</span> <span class="fu">filter</span><span class="op">(</span><span class="va">p.adjust</span> <span class="op">&lt;=</span> <span class="fl">0.05</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">pull</span><span class="op">(</span><span class="va">ID</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">unique</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">length</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div id="challenge-5" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-5" class="callout-inner">
<h3 class="callout-title">Challenge 5</h3>
<div class="callout-content">
<p>The tally above represents all genes, both up- and down-regulatd. To
compare between GSEA and ORA, can you identify how many GSEA enriched
terms are associated with up-regulated genes and how many are associated
with down-regulated genes? (Hint: the <code>NES</code> value within the
results relates to the directionality of enrichment).</p>
</div>
</div>
</div>
<div id="accordionSolution5" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution5" aria-expanded="false" aria-controls="collapseSolution5">
  <h4 class="accordion-header" id="headingSolution5"> Show me the solution </h4>
</button>
<div id="collapseSolution5" class="accordion-collapse collapse" data-bs-parent="#accordionSolution5" aria-labelledby="headingSolution5">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb53">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="va">enr</span><span class="op">@</span><span class="va">result</span> <span class="op">%&gt;%</span> <span class="fu">filter</span><span class="op">(</span><span class="va">p.adjust</span> <span class="op">&lt;=</span> <span class="fl">0.05</span>, <span class="va">NES</span> <span class="op">&lt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">pull</span><span class="op">(</span><span class="va">ID</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">unique</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">length</span><span class="op">(</span><span class="op">)</span>  </span>
<span> <span class="va">enr</span><span class="op">@</span><span class="va">result</span> <span class="op">%&gt;%</span> <span class="fu">filter</span><span class="op">(</span><span class="va">p.adjust</span> <span class="op">&lt;=</span> <span class="fl">0.05</span>, <span class="va">NES</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">pull</span><span class="op">(</span><span class="va">ID</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">unique</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">length</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<p>Plot the term enrichments</p>
<div class="codewrapper sourceCode" id="cb54">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ridgeplot</span><span class="op">(</span><span class="va">enr</span>, core_enrichment <span class="op">=</span> <span class="cn">T</span>, showCategory <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="results/ridgePlot.png" alt="ridgeplot" class="figure mx-auto d-block"><div class="figcaption">ridgeplot</div>
</figure><p>This plot shows the top 15 GSEA enriched terms. The displayed terms
are all from the up-regulated class (i.e. <code>NES &gt; 0</code>), and
consist of many immune-relevant terms (e.g. “immune response” and
“cytokine production”).</p>
</div>
<div class="section level3">
<h3 id="common-pitfalls-best-practices">Common pitfalls &amp; best practices<a class="anchor" aria-label="anchor" href="#common-pitfalls-best-practices"></a></h3>
<p>These kinds of functional enrichment analyses are very common, but
not all results reported are equal! A recent paper describes an <a href="https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1009935" class="external-link">“Urgent
need for consistent standards in functional enrichment analysis”</a>.
They examine how the results of functional enrichment analyses are
reported in the literature, and identify several common shortcomings.
Watch out for these common mistakes when performing and reporting your
own analyses!</p>
<figure><img src="fig/rmd04-Wijesooriya_PLOS_CompBio_F2_cropped.png" alt="Common pitfalls" class="figure mx-auto d-block"><div class="figcaption">Common pitfalls</div>
</figure></div>
</section><section><h2 class="section-heading" id="alzheimerss-disease-biological-domains">Alzheimers’s Disease Biological Domains<a class="anchor" aria-label="anchor" href="#alzheimerss-disease-biological-domains"></a></h2>
<hr class="half-width"><p>While these results are informative and help to provide essential
biological context to the results of the omics experiment, it is
difficult to understand all of the enriched terms and what that means
for the biology of disease. It would be useful to group each of the
enriched terms within broader areas of disease biology. There are
several common molecular endophenotypes that are detected within human
Alzheimer’s cohorts across omics data types (transcriptomics,
proteomics, and genetics). Several of these endophenotypic areas are
shown in the figure below (source: Jesse Wiley).</p>
<figure><img src="fig/rmd04-AD_endophenotypes.png" alt="Endophenotypes of AD" class="figure mx-auto d-block"><div class="figcaption">Endophenotypes of AD</div>
</figure><p>These endophenotypes describe molecular processes that are
dysregulated by or during the disease process. Very similar sets of
endophenotypes have been cataloged among the targets of therapeutics in
clinical trials for AD (see below, <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC10210334/" class="external-link">Cummings
et al, Alzheimer’s disease drug development pipeline: 2023, Alz Dem
TRCI</a>.</p>
<figure><img src="fig/rmd04-CADRO_2023.jpg" alt="Common AD Research Ontology" class="figure mx-auto d-block"><div class="figcaption">Common AD Research Ontology</div>
</figure><figure><img src="fig/rmd04-CADRO_2023_2.jpg" alt="Drugs in Pipeline by CADRO" class="figure mx-auto d-block"><div class="figcaption">Drugs in Pipeline by CADRO</div>
</figure><p>In order to formalize and operationalize these endophenotypic areas,
the <a href="treatad.org/emory-sage-sgc/">Emory-Sage-SGC center of the
TREAT-AD consortium</a> has developed the <a href="https://alz-journals.onlinelibrary.wiley.com/doi/pdfdirect/10.1002/trc2.12461" class="external-link">Biological
Domains of AD</a>. In the enumeration of these domains, several criteria
were established; the biological domains defined should be:</p>
<ul><li>
<em>objective:</em> leverage existing well-annotated resources<br></li>
<li>
<em>automatable:</em> in CADRO, therapeutics and targets are
manually assigned<br></li>
<li>
<em>intelligible:</em> groupings should be easy to understand<br></li>
<li>
<em>modifiable:</em> definitions should be (and are!) continuously
be updated.</li>
</ul><p>In all, 19 distinct biological domains (aka biodomains) have been
identified. These biological domains are defined using sets of GO terms
that align with the endophenotype. For example, terms like “cytokine
receptor binding” and “leukocyte migration” are annotated to the
<code>Immune Response</code> biodomain, while terms like “postsynaptic
density” and “synaptic vesicle cycle” are annotated to the
<code>Synapse</code> biodomain. Of all terms in the GO, 7,127 terms
(16.4%) are annotated to one of the biological domains. Because the GO
terms have genes annotated, genes can be associated with specific
endophenotypes via the biological domain groupings of terms. In all,
18,289 genes are annotated to at least 1 biodomain term. While the
biodomains exhibit very few overlapping GO terms (panel A), due to gene
pleiotropy (etc) the number of overlapping genes between biological
domains is quite a bit higher (panel B). The development of the
biological domains is described in more detail in the published paper <a href="doi.org/10.1002/trc2.12461">Genetic and Multi-omic Risk Assessment
of Alzheimer’s Disease Implicates Core Associated Biological
Domains</a>.</p>
<figure><img src="fig/rmd04-score_domains_preprint_F1_cropped.jpeg" alt="AD Biodomain Demographics" class="figure mx-auto d-block"><div class="figcaption">AD Biodomain Demographics</div>
</figure><div class="section level3">
<h3 id="download-and-explore-the-biological-domain-annotations">Download and explore the biological domain annotations<a class="anchor" aria-label="anchor" href="#download-and-explore-the-biological-domain-annotations"></a></h3>
<p>First let’s download the biodomain definition file from synapse.</p>
<div class="codewrapper sourceCode" id="cb55">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#synLogin()</span></span>
<span></span>
<span><span class="co"># biodomain definitions</span></span>
<span><span class="va">biodom</span> <span class="op">&lt;-</span> <span class="fu">readRDS</span><span class="op">(</span><span class="fu">synGet</span><span class="op">(</span><span class="st">'syn25428992'</span><span class="op">)</span><span class="op">$</span><span class="va">path</span><span class="op">)</span></span>
<span><span class="va">dom.lab</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="fu">synGet</span><span class="op">(</span><span class="st">'syn26856828'</span><span class="op">)</span><span class="op">$</span><span class="va">path</span><span class="op">)</span></span></code></pre>
</div>
<p>What is in the file?</p>
<div class="codewrapper sourceCode" id="cb56">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">head</span><span class="op">(</span><span class="va">biodom</span><span class="op">)</span></span></code></pre>
</div>
<p>You can see the file is a list of GO term accessions
(<code>GO_ID</code>) and names (<code>GOterm_Name</code>) as well as the
corresponding endophenotype (<code>Biodomain</code>) to which the term
is annotated. There are also gene annotations for each term. These
annotation sets come from two sources: (1) the <code>symbol</code> and
<code>uniprot</code> annotations are drawn directly from the Gene
Ontology via the provided API, (2) <code>ensembl_id</code>,
<code>entrez_id</code>, and <code>hgnc_symbol</code> are from BioMart
annotations (e.g. <code>biomaRt::getLDS()</code>).</p>
<p>We can see how many GO terms are annotated to each biodomain:</p>
<div class="codewrapper sourceCode" id="cb57">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">biodom</span> <span class="op">%&gt;%</span> <span class="fu">group_by</span><span class="op">(</span><span class="va">Biodomain</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">summarise</span><span class="op">(</span>n_term <span class="op">=</span> <span class="fu">length</span><span class="op">(</span><span class="fu">unique</span><span class="op">(</span><span class="va">GO_ID</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">arrange</span><span class="op">(</span><span class="va">n_term</span><span class="op">)</span> </span></code></pre>
</div>
<p>The biodomains range in size from <code>Tau Homeostasis</code> (10
terms) up to <code>Synapse</code> (1,379 terms).</p>
<p>We can also investigate the individual genes annotated to each
biodomain GO term.</p>
<div class="codewrapper sourceCode" id="cb58">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">biodom</span> <span class="op">%&gt;%</span> <span class="fu">filter</span><span class="op">(</span><span class="va">GOterm_Name</span> <span class="op">==</span> <span class="st">'amyloid-beta formation'</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">pull</span><span class="op">(</span><span class="va">symbol</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">unlist</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<p>So the genes associated with <code>amyloid-beta formation</code>
within the <code>APP Metabolism</code> biodomain include PSEN1, PSEN2,
BACE1, ABCA7, NCSTN, and others.</p>
</div>
<div class="section level3">
<h3 id="annotate-enriched-terms-with-biological-domain">Annotate enriched terms with biological domain<a class="anchor" aria-label="anchor" href="#annotate-enriched-terms-with-biological-domain"></a></h3>
<p>Let’s re-characterize the 5xFAD functional enrichments we computed
previously with the biological domain annotations and see if we can get
more context about what is changing in that model. We’ll focus on the
GSEA results and start by annotating the results with biodomain
groupings.</p>
<div class="codewrapper sourceCode" id="cb59">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">enr.bd</span> <span class="op">=</span> <span class="va">enr</span><span class="op">@</span><span class="va">result</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">left_join</span><span class="op">(</span><span class="va">.</span>, <span class="va">biodom</span> <span class="op">%&gt;%</span> <span class="fu">select</span><span class="op">(</span><span class="va">Biodomain</span>, ID <span class="op">=</span> <span class="va">GO_ID</span><span class="op">)</span>, by <span class="op">=</span> <span class="st">'ID'</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">relocate</span><span class="op">(</span><span class="va">Biodomain</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">head</span><span class="op">(</span><span class="va">enr.bd</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span></span></code></pre>
</div>
<p>Not all of the enriched terms are annotated to a biological domain.
Some terms are too broad and not specific (e.g. ‘defense response’),
while others may not have been captured by a biological domain
annotation yet (e.g. ‘regulation of immune system process’). Remember
that the conception of the biodomains involved a requirement that they
be modifiable, and these terms may be added to the biodomain
definintions in the future. Let’s modify the <code>Biodomain</code>
value for terms that aren’t annotated to a domain to ‘none’.</p>
<div class="codewrapper sourceCode" id="cb60">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">enr.bd</span><span class="op">$</span><span class="va">Biodomain</span><span class="op">[</span><span class="fu">is.na</span><span class="op">(</span><span class="va">enr.bd</span><span class="op">$</span><span class="va">Biodomain</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">'none'</span></span>
<span><span class="fu">head</span><span class="op">(</span><span class="va">enr.bd</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span></span></code></pre>
</div>
<p>How many terms are enriched from each domain?</p>
<div class="codewrapper sourceCode" id="cb61">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bd.tally</span> <span class="op">=</span> <span class="fu">tibble</span><span class="op">(</span>domain <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fu">unique</span><span class="op">(</span><span class="va">biodom</span><span class="op">$</span><span class="va">Biodomain</span><span class="op">)</span>, <span class="st">'none'</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">rowwise</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    n_term <span class="op">=</span> <span class="va">biodom</span><span class="op">$</span><span class="va">GO_ID</span><span class="op">[</span> <span class="va">biodom</span><span class="op">$</span><span class="va">Biodomain</span> <span class="op">==</span> <span class="va">domain</span> <span class="op">]</span> <span class="op">%&gt;%</span> <span class="fu">unique</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">length</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    n_sig_term <span class="op">=</span> <span class="va">enr.bd</span><span class="op">$</span><span class="va">ID</span><span class="op">[</span> <span class="va">enr.bd</span><span class="op">$</span><span class="va">Biodomain</span> <span class="op">==</span> <span class="va">domain</span> <span class="op">]</span> <span class="op">%&gt;%</span> <span class="fu">unique</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">length</span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="fu">arrange</span><span class="op">(</span><span class="va">bd.tally</span>, <span class="fu">desc</span><span class="op">(</span><span class="va">n_sig_term</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<p>Many enriched terms don’t map to a domain (), but most do (). Of
those that do, the vast majority map into the
<code>Immune Response</code> biodomain.</p>
<p>We can plot the enrichment results, stratified by biodomain:</p>
<div class="codewrapper sourceCode" id="cb62">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">enr.bd_plot</span> <span class="op">&lt;-</span> <span class="fu">full_join</span><span class="op">(</span><span class="va">enr.bd</span>, <span class="va">dom.lab</span>, by <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">'Biodomain'</span> <span class="op">=</span> <span class="st">'domain'</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>Biodomain <span class="op">=</span> <span class="fu">factor</span><span class="op">(</span><span class="va">Biodomain</span>, levels <span class="op">=</span> <span class="fu">arrange</span><span class="op">(</span><span class="va">bd.tally</span>, <span class="va">n_sig_term</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">pull</span><span class="op">(</span><span class="va">domain</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">arrange</span><span class="op">(</span><span class="va">Biodomain</span>, <span class="va">p.adjust</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">enr.bd_plot</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">NES</span>, <span class="va">Biodomain</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_violin</span><span class="op">(</span>data <span class="op">=</span> <span class="fu">subset</span><span class="op">(</span><span class="va">enr.bd_plot</span>, <span class="va">NES</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span>, </span>
<span>              <span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">color</span><span class="op">)</span>, scale <span class="op">=</span> <span class="st">'width'</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_violin</span><span class="op">(</span>data <span class="op">=</span> <span class="fu">subset</span><span class="op">(</span><span class="va">enr.bd_plot</span>, <span class="va">NES</span> <span class="op">&lt;</span> <span class="fl">0</span><span class="op">)</span>, </span>
<span>              <span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">color</span><span class="op">)</span>, scale <span class="op">=</span> <span class="st">'width'</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_jitter</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>size <span class="op">=</span> <span class="op">-</span><span class="fu">log10</span><span class="op">(</span><span class="va">p.adjust</span><span class="op">)</span>, fill <span class="op">=</span> <span class="va">color</span><span class="op">)</span>, </span>
<span>              color <span class="op">=</span> <span class="st">'grey20'</span>, shape <span class="op">=</span> <span class="fl">21</span>, alpha <span class="op">=</span> <span class="fl">.3</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span>, lwd <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">scale_y_discrete</span><span class="op">(</span>drop <span class="op">=</span> <span class="cn">F</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">scale_fill_identity</span><span class="op">(</span><span class="op">)</span><span class="op">+</span><span class="fu">scale_color_identity</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="results/biodom_plot.png" alt="ridgeplot" class="figure mx-auto d-block"><div class="figcaption">ridgeplot</div>
</figure><div id="challenge-6" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-6" class="callout-inner">
<h3 class="callout-title">Challenge 6</h3>
<div class="callout-content">
<p>How could you plot the results from the ORA to show biodomain
enrichements?</p>
</div>
</div>
</div>
<div id="accordionSolution6" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution6" aria-expanded="false" aria-controls="collapseSolution6">
  <h4 class="accordion-header" id="headingSolution6"> Show me the solution </h4>
</button>
<div id="collapseSolution6" class="accordion-collapse collapse" data-bs-parent="#accordionSolution6" aria-labelledby="headingSolution6">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb63">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="va">enr.ora</span> <span class="op">=</span> <span class="fu">bind_rows</span><span class="op">(</span></span>
<span>  <span class="va">enr.up</span><span class="op">@</span><span class="va">result</span> <span class="op">%&gt;%</span> <span class="fu">mutate</span><span class="op">(</span>dir <span class="op">=</span> <span class="st">'up'</span><span class="op">)</span>,</span>
<span>  <span class="va">enr.dn</span><span class="op">@</span><span class="va">result</span> <span class="op">%&gt;%</span> <span class="fu">mutate</span><span class="op">(</span>dir <span class="op">=</span> <span class="st">'dn'</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">left_join</span><span class="op">(</span><span class="va">.</span>, <span class="va">biodom</span> <span class="op">%&gt;%</span> <span class="fu">select</span><span class="op">(</span><span class="va">Biodomain</span>, ID <span class="op">=</span> <span class="va">GO_ID</span><span class="op">)</span>, by <span class="op">=</span> <span class="st">'ID'</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">relocate</span><span class="op">(</span><span class="va">Biodomain</span><span class="op">)</span></span>
<span></span>
<span> <span class="va">enr.ora</span><span class="op">$</span><span class="va">Biodomain</span><span class="op">[</span><span class="fu">is.na</span><span class="op">(</span><span class="va">enr.ora</span><span class="op">$</span><span class="va">Biodomain</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">'none'</span></span>
<span> </span>
<span> <span class="va">bd.tally</span> <span class="op">=</span> <span class="fu">tibble</span><span class="op">(</span>domain <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fu">unique</span><span class="op">(</span><span class="va">biodom</span><span class="op">$</span><span class="va">Biodomain</span><span class="op">)</span>, <span class="st">'none'</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>   <span class="fu">rowwise</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>   <span class="fu">mutate</span><span class="op">(</span></span>
<span>     n_term <span class="op">=</span> <span class="va">biodom</span><span class="op">$</span><span class="va">GO_ID</span><span class="op">[</span> <span class="va">biodom</span><span class="op">$</span><span class="va">Biodomain</span> <span class="op">==</span> <span class="va">domain</span> <span class="op">]</span> <span class="op">%&gt;%</span> <span class="fu">unique</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">length</span><span class="op">(</span><span class="op">)</span>,</span>
<span>     n_sig_term <span class="op">=</span> <span class="va">enr.ora</span><span class="op">$</span><span class="va">ID</span><span class="op">[</span> <span class="va">enr.ora</span><span class="op">$</span><span class="va">Biodomain</span> <span class="op">==</span> <span class="va">domain</span> <span class="op">]</span> <span class="op">%&gt;%</span> <span class="fu">unique</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">length</span><span class="op">(</span><span class="op">)</span></span>
<span>     <span class="op">)</span></span>
<span></span>
<span> <span class="va">enr.ora</span> <span class="op">&lt;-</span> <span class="fu">full_join</span><span class="op">(</span><span class="va">enr.ora</span>, <span class="va">dom.lab</span>, by <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">'Biodomain'</span> <span class="op">=</span> <span class="st">'domain'</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>   <span class="fu">mutate</span><span class="op">(</span>Biodomain <span class="op">=</span> <span class="fu">factor</span><span class="op">(</span><span class="va">Biodomain</span>, levels <span class="op">=</span> <span class="fu">arrange</span><span class="op">(</span><span class="va">bd.tally</span>, <span class="va">n_sig_term</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">pull</span><span class="op">(</span><span class="va">domain</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>   <span class="fu">arrange</span><span class="op">(</span><span class="va">Biodomain</span>, <span class="va">p.adjust</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>   <span class="fu">mutate</span><span class="op">(</span>signed_logP <span class="op">=</span> <span class="op">-</span><span class="fu">log10</span><span class="op">(</span><span class="va">p.adjust</span><span class="op">)</span>,</span>
<span>          signed_logP <span class="op">=</span> <span class="fu">if_else</span><span class="op">(</span><span class="va">dir</span> <span class="op">==</span> <span class="st">'dn'</span>, <span class="op">-</span><span class="fl">1</span><span class="op">*</span><span class="va">signed_logP</span>, <span class="va">signed_logP</span><span class="op">)</span><span class="op">)</span></span>
<span>   </span>
<span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">enr.ora</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">signed_logP</span>, <span class="va">Biodomain</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu">geom_violin</span><span class="op">(</span>data <span class="op">=</span> <span class="fu">subset</span><span class="op">(</span><span class="va">enr.ora</span>, <span class="va">dir</span> <span class="op">==</span> <span class="st">'up'</span><span class="op">)</span>, <span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">color</span><span class="op">)</span>, scale <span class="op">=</span> <span class="st">'width'</span><span class="op">)</span><span class="op">+</span></span>
<span>   <span class="fu">geom_violin</span><span class="op">(</span>data <span class="op">=</span> <span class="fu">subset</span><span class="op">(</span><span class="va">enr.ora</span>, <span class="va">dir</span> <span class="op">==</span> <span class="st">'dn'</span><span class="op">)</span>, <span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">color</span><span class="op">)</span>, scale <span class="op">=</span> <span class="st">'width'</span><span class="op">)</span><span class="op">+</span></span>
<span>   <span class="fu">geom_jitter</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>size <span class="op">=</span> <span class="va">Count</span>, fill <span class="op">=</span> <span class="va">color</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">'grey20'</span>, shape <span class="op">=</span> <span class="fl">21</span>, alpha <span class="op">=</span> <span class="fl">.3</span><span class="op">)</span><span class="op">+</span></span>
<span>   <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span>, lwd <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span><span class="op">+</span></span>
<span>   <span class="fu">scale_y_discrete</span><span class="op">(</span>drop <span class="op">=</span> <span class="cn">F</span><span class="op">)</span><span class="op">+</span></span>
<span>   <span class="fu">scale_fill_identity</span><span class="op">(</span><span class="op">)</span><span class="op">+</span><span class="fu">scale_color_identity</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<p>Based on the gene list (up or down) we can add a sign to the
significance. When we plot this we can see there are many more
significantly enriched terms from the ORA. The dominant signal is still
the up-regulation of terms from the <code>Immune Response</code>
biodomain. There is also nearly exclusive up-regulation of terms from
the <code>Autophagy</code>, <code>Metal Binding and Homeostasis</code>,
<code>Oxidative Stress</code>, and <code>APP Metabolism</code> domains.
The most down-regulated terms are from the <code>Synapse</code>
biodomain.</p>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="comparing-human-and-mouse-functional-enrichments">Comparing Human and Mouse functional enrichments<a class="anchor" aria-label="anchor" href="#comparing-human-and-mouse-functional-enrichments"></a></h3>
<p>Finally let’s consider how we can compare the functional enrichments
in the mouse models with functional enrichments from the AMP-AD cohorts.
We can first take a look at the functional enrichments from the
different human cohorts. To save some time, let’s load some pre-computed
enrichment results for mouse &amp; human data.</p>
<div class="codewrapper sourceCode" id="cb64">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mm.gsea</span> <span class="op">&lt;-</span> <span class="fu">bind_rows</span><span class="op">(</span></span>
<span>  <span class="fu">read_tsv</span><span class="op">(</span><span class="st">'data/5xFAD_gsea_results.tsv'</span>, col_types <span class="op">=</span> <span class="fu">cols</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">mutate</span><span class="op">(</span>age <span class="op">=</span> <span class="fu">str_remove_all</span><span class="op">(</span><span class="va">age</span>, <span class="st">' mo'</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">as.double</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">read_tsv</span><span class="op">(</span><span class="st">'data/LOAD1_gsea_results.tsv'</span>, col_types <span class="op">=</span> <span class="fu">cols</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">hs.gsea</span> <span class="op">&lt;-</span> <span class="fu">read_tsv</span><span class="op">(</span><span class="st">'data/Hsap_gsea_results.tsv'</span>, col_types <span class="op">=</span> <span class="fu">cols</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<p>The cohorts and tissues available are:</p>
<div class="codewrapper sourceCode" id="cb65">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hs.gsea</span> <span class="op">%&gt;%</span> <span class="fu">select</span><span class="op">(</span><span class="va">Study</span>, <span class="va">Tissue</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">distinct</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 6 × 2
  Study  Tissue
  &lt;chr&gt;  &lt;chr&gt;
1 MAYO   CBE
2 MAYO   TCX
3 MSSM   STG
4 MSSM   PHG
5 MSSM   IFG
6 ROSMAP DLPFC </code></pre>
</div>
<p>We can focus on one tissue per cohort, let’s look at TCX for Mayo,
PHG for Mt Sinai, and DLPFC for ROSMAP.</p>
<div class="codewrapper sourceCode" id="cb67">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">enr.bd</span> <span class="op">=</span> <span class="va">hs.gsea</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">Tissue</span> <span class="op">%in%</span> <span class="fu">c</span><span class="op">(</span><span class="st">'TCX'</span>,<span class="st">'PHG'</span>,<span class="st">'DLPFC'</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">left_join</span><span class="op">(</span><span class="va">.</span>, <span class="va">biodom</span> <span class="op">%&gt;%</span> <span class="fu">select</span><span class="op">(</span><span class="va">Biodomain</span>, ID <span class="op">=</span> <span class="va">GO_ID</span><span class="op">)</span>, by <span class="op">=</span> <span class="st">'ID'</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">relocate</span><span class="op">(</span><span class="va">Biodomain</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>Biodomain <span class="op">=</span> <span class="fu">if_else</span><span class="op">(</span> <span class="fu">is.na</span><span class="op">(</span><span class="va">Biodomain</span><span class="op">)</span>, <span class="st">'none'</span>, <span class="va">Biodomain</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">bd.tally</span> <span class="op">=</span> <span class="fu">tibble</span><span class="op">(</span>domain <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fu">unique</span><span class="op">(</span><span class="va">biodom</span><span class="op">$</span><span class="va">Biodomain</span><span class="op">)</span>, <span class="st">'none'</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">rowwise</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    n_term <span class="op">=</span> <span class="va">biodom</span><span class="op">$</span><span class="va">GO_ID</span><span class="op">[</span> <span class="va">biodom</span><span class="op">$</span><span class="va">Biodomain</span> <span class="op">==</span> <span class="va">domain</span> <span class="op">]</span> <span class="op">%&gt;%</span> <span class="fu">unique</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">length</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    n_sig_term <span class="op">=</span> <span class="va">enr.bd</span><span class="op">$</span><span class="va">ID</span><span class="op">[</span> <span class="va">enr.bd</span><span class="op">$</span><span class="va">Biodomain</span> <span class="op">==</span> <span class="va">domain</span> <span class="op">]</span> <span class="op">%&gt;%</span> <span class="fu">unique</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">length</span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="va">enr.bd</span> <span class="op">&lt;-</span> <span class="fu">full_join</span><span class="op">(</span><span class="va">enr.bd</span>, <span class="va">dom.lab</span>, by <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">'Biodomain'</span> <span class="op">=</span> <span class="st">'domain'</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="op">!</span><span class="fu">is.na</span><span class="op">(</span><span class="va">Study</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>Biodomain <span class="op">=</span> <span class="fu">factor</span><span class="op">(</span><span class="va">Biodomain</span>, levels <span class="op">=</span> <span class="fu">arrange</span><span class="op">(</span><span class="va">bd.tally</span>, <span class="va">n_sig_term</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">pull</span><span class="op">(</span><span class="va">domain</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">arrange</span><span class="op">(</span><span class="va">Biodomain</span>, <span class="va">p.adjust</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">enr.bd</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">NES</span>, <span class="va">Biodomain</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_violin</span><span class="op">(</span>data <span class="op">=</span> <span class="fu">subset</span><span class="op">(</span><span class="va">enr.bd</span>, <span class="va">NES</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span>, <span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">color</span><span class="op">)</span>, scale <span class="op">=</span> <span class="st">'width'</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_violin</span><span class="op">(</span>data <span class="op">=</span> <span class="fu">subset</span><span class="op">(</span><span class="va">enr.bd</span>, <span class="va">NES</span> <span class="op">&lt;</span> <span class="fl">0</span><span class="op">)</span>, <span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">color</span><span class="op">)</span>, scale <span class="op">=</span> <span class="st">'width'</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>size <span class="op">=</span> <span class="op">-</span><span class="fu">log10</span><span class="op">(</span><span class="va">p.adjust</span><span class="op">)</span>, fill <span class="op">=</span> <span class="va">color</span>, group <span class="op">=</span> <span class="va">ID</span><span class="op">)</span>, </span>
<span>              color <span class="op">=</span> <span class="st">'grey20'</span>, shape <span class="op">=</span> <span class="fl">21</span>, alpha <span class="op">=</span> <span class="fl">.5</span>, position <span class="op">=</span> <span class="fu">position_jitter</span><span class="op">(</span>width <span class="op">=</span> <span class="fl">.25</span>, seed <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>  <span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span>, lwd <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="fu">paste0</span><span class="op">(</span><span class="va">Study</span>, <span class="st">': '</span>, <span class="va">Tissue</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">'top'</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">scale_fill_identity</span><span class="op">(</span><span class="op">)</span><span class="op">+</span><span class="fu">scale_color_identity</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<p>Huh, the Mayo and MSSM look largely similar, but the ROSMAP DLPFC
doesn’t have very many enriched terms. Let’s ignore the ROSMAP result
for now and compare the terms enriched between Mayo TCX and the 5xFAD
males. First we can join up the enriched terms between the sets into one
data frame.</p>
<div class="codewrapper sourceCode" id="cb68">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">comb_5x</span> <span class="op">=</span> <span class="fu">bind_rows</span><span class="op">(</span></span>
<span>  <span class="va">hs.gsea</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">filter</span><span class="op">(</span><span class="va">Study</span> <span class="op">==</span> <span class="st">'MAYO'</span>, <span class="va">Tissue</span> <span class="op">==</span> <span class="st">'TCX'</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">mutate</span><span class="op">(</span>species <span class="op">=</span> <span class="st">'hs'</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">select</span><span class="op">(</span><span class="va">ID</span>, <span class="va">Description</span>, <span class="va">species</span>, <span class="va">NES</span>, <span class="va">p.adjust</span><span class="op">)</span>,</span>
<span>  <span class="va">mm.gsea</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">filter</span><span class="op">(</span><span class="va">model</span> <span class="op">==</span> <span class="st">'5xFAD'</span>, <span class="va">sex</span> <span class="op">==</span> <span class="st">'male'</span>, <span class="va">age</span> <span class="op">==</span> <span class="fl">12</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">mutate</span><span class="op">(</span>species <span class="op">=</span> <span class="st">'mm'</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">select</span><span class="op">(</span><span class="va">ID</span>, <span class="va">Description</span>, <span class="va">species</span>, <span class="va">NES</span>, <span class="va">p.adjust</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">pivot_wider</span><span class="op">(</span>id_cols <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="va">ID</span>, <span class="va">Description</span><span class="op">)</span>, </span>
<span>              names_from <span class="op">=</span> <span class="va">species</span>, </span>
<span>              values_from <span class="op">=</span> <span class="va">NES</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">unnest</span><span class="op">(</span>cols <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="va">hs</span>,<span class="va">mm</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span><span class="fu">across</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="va">hs</span>,<span class="va">mm</span><span class="op">)</span>, <span class="op">~</span> <span class="fu">if_else</span><span class="op">(</span><span class="fu">is.na</span><span class="op">(</span><span class="va">.x</span><span class="op">)</span>, <span class="fl">0</span>, <span class="va">.x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu">head</span><span class="op">(</span><span class="va">comb_5x</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 6 × 4
  ID         Description                                 hs    mm
  &lt;chr&gt;      &lt;chr&gt;                                    &lt;dbl&gt; &lt;dbl&gt;
1 GO:0001568 blood vessel development                  3.20     0
2 GO:0048514 blood vessel morphogenesis                3.18     0
3 GO:0001944 vasculature development                   3.17     0
4 GO:0001525 angiogenesis                              3.16     0
5 GO:0062023 collagen-containing extracellular matrix  3.15     0
6 GO:0042060 wound healing                             3.06     0</code></pre>
</div>
<p>Great! Now let’s annotate the biodomains and plot it up:</p>
<div class="codewrapper sourceCode" id="cb70">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">enr.bd</span> <span class="op">&lt;-</span> <span class="va">comb_5x</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">left_join</span><span class="op">(</span><span class="va">.</span>, <span class="va">biodom</span> <span class="op">%&gt;%</span> <span class="fu">select</span><span class="op">(</span><span class="va">Biodomain</span>, ID <span class="op">=</span> <span class="va">GO_ID</span><span class="op">)</span>, by <span class="op">=</span> <span class="st">'ID'</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">relocate</span><span class="op">(</span><span class="va">Biodomain</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>Biodomain <span class="op">=</span> <span class="fu">if_else</span><span class="op">(</span> <span class="fu">is.na</span><span class="op">(</span><span class="va">Biodomain</span><span class="op">)</span>, <span class="st">'none'</span>, <span class="va">Biodomain</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">bd.tally</span> <span class="op">=</span> <span class="fu">tibble</span><span class="op">(</span>domain <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fu">unique</span><span class="op">(</span><span class="va">biodom</span><span class="op">$</span><span class="va">Biodomain</span><span class="op">)</span>, <span class="st">'none'</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">rowwise</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    n_term <span class="op">=</span> <span class="va">biodom</span><span class="op">$</span><span class="va">GO_ID</span><span class="op">[</span> <span class="va">biodom</span><span class="op">$</span><span class="va">Biodomain</span> <span class="op">==</span> <span class="va">domain</span> <span class="op">]</span> <span class="op">%&gt;%</span> <span class="fu">unique</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">length</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    n_sig_term <span class="op">=</span> <span class="va">enr.bd</span><span class="op">$</span><span class="va">ID</span><span class="op">[</span> <span class="va">enr.bd</span><span class="op">$</span><span class="va">Biodomain</span> <span class="op">==</span> <span class="va">domain</span> <span class="op">]</span> <span class="op">%&gt;%</span> <span class="fu">unique</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">length</span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="va">enr.bd</span> <span class="op">&lt;-</span> <span class="fu">full_join</span><span class="op">(</span><span class="va">enr.bd</span>, <span class="va">dom.lab</span>, by <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">'Biodomain'</span> <span class="op">=</span> <span class="st">'domain'</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>Biodomain <span class="op">=</span> <span class="fu">factor</span><span class="op">(</span><span class="va">Biodomain</span>, </span>
<span>                            levels <span class="op">=</span> <span class="fu">arrange</span><span class="op">(</span><span class="va">bd.tally</span>, <span class="fu">desc</span><span class="op">(</span><span class="va">n_sig_term</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">pull</span><span class="op">(</span><span class="va">domain</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">arrange</span><span class="op">(</span><span class="va">Biodomain</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">enr.bd</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">hs</span>, <span class="va">mm</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">color</span><span class="op">)</span>,color <span class="op">=</span> <span class="st">'grey20'</span>, shape <span class="op">=</span> <span class="fl">21</span>, alpha <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span>, lwd <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, lwd <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">'Mayo TCX\nGSEA NES'</span>, y <span class="op">=</span> <span class="st">'12mo male 5xFAD\nGSEA NES'</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">Biodomain</span>, scales <span class="op">=</span> <span class="st">'free'</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">scale_fill_identity</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<p>There are several terms from multiple biodomains that are enriched in
similar directions (i.e. from the up-regulated genes in both human AD
and 5xFAD). There are fewer that are enriched in opposite directions
(i.e. up in human AD and down in 5xFAD, e.g. see Vasculature and
Mitochondrial Metabolism), but there are many terms that are unique to
either the human or the mouse data set.</p>
<p>Overall, by aligning human and mouse omics signatures through the
lens of domains affected in each context, we can get a better
understanding of the relationships between the biological processes
affected in each context.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul><li>AMP-AD gene modules represent major transcriptomic heterogeneity in
AD</li>
<li>Correlation of logFC is a practical approach for human-mouse
alignment of AD-associated transcriptomic signatures</li>
<li>Functional gene set signatures are also a useful point of comparison
between species</li>
<li>Subsetting functions into associated Biological Domains allows for
more granular comparisons.</li>
</ul></div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="session-info">Session Info<a class="anchor" aria-label="anchor" href="#session-info"></a></h2>
<hr class="half-width"><div class="codewrapper sourceCode" id="cb71">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode r" tabindex="0"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span>
<span id="cb71-2"><a href="#cb71-2" tabindex="-1"></a>R version <span class="dv">4</span>.<span class="fl">4.2</span> (<span class="dv">2024-10-31</span>)</span>
<span id="cb71-3"><a href="#cb71-3" tabindex="-1"></a>Platform<span class="sc">:</span> x86_64<span class="sc">-</span>pc<span class="sc">-</span>linux<span class="sc">-</span>gnu</span>
<span id="cb71-4"><a href="#cb71-4" tabindex="-1"></a>Running under<span class="sc">:</span> Ubuntu <span class="dv">22</span>.<span class="fl">04.5</span> LTS</span>
<span id="cb71-5"><a href="#cb71-5" tabindex="-1"></a></span>
<span id="cb71-6"><a href="#cb71-6" tabindex="-1"></a>Matrix products<span class="sc">:</span> default</span>
<span id="cb71-7"><a href="#cb71-7" tabindex="-1"></a>BLAS<span class="sc">:</span>   <span class="er">/</span>usr<span class="sc">/</span>lib<span class="sc">/</span>x86_64<span class="sc">-</span>linux<span class="sc">-</span>gnu<span class="sc">/</span>blas<span class="sc">/</span>libblas.so.<span class="dv">3</span>.<span class="fl">10.0</span> </span>
<span id="cb71-8"><a href="#cb71-8" tabindex="-1"></a>LAPACK<span class="sc">:</span> <span class="er">/</span>usr<span class="sc">/</span>lib<span class="sc">/</span>x86_64<span class="sc">-</span>linux<span class="sc">-</span>gnu<span class="sc">/</span>lapack<span class="sc">/</span>liblapack.so.<span class="dv">3</span>.<span class="fl">10.0</span></span>
<span id="cb71-9"><a href="#cb71-9" tabindex="-1"></a></span>
<span id="cb71-10"><a href="#cb71-10" tabindex="-1"></a>locale<span class="sc">:</span></span>
<span id="cb71-11"><a href="#cb71-11" tabindex="-1"></a> [<span class="dv">1</span>] LC_CTYPE<span class="ot">=</span>C.UTF<span class="dv">-8</span>       LC_NUMERIC<span class="ot">=</span>C           LC_TIME<span class="ot">=</span>C.UTF<span class="dv">-8</span>       </span>
<span id="cb71-12"><a href="#cb71-12" tabindex="-1"></a> [<span class="dv">4</span>] LC_COLLATE<span class="ot">=</span>C.UTF<span class="dv">-8</span>     LC_MONETARY<span class="ot">=</span>C.UTF<span class="dv">-8</span>    LC_MESSAGES<span class="ot">=</span>C.UTF<span class="dv">-8</span>   </span>
<span id="cb71-13"><a href="#cb71-13" tabindex="-1"></a> [<span class="dv">7</span>] LC_PAPER<span class="ot">=</span>C.UTF<span class="dv">-8</span>       LC_NAME<span class="ot">=</span>C              LC_ADDRESS<span class="ot">=</span>C          </span>
<span id="cb71-14"><a href="#cb71-14" tabindex="-1"></a>[<span class="dv">10</span>] LC_TELEPHONE<span class="ot">=</span>C         LC_MEASUREMENT<span class="ot">=</span>C.UTF<span class="dv">-8</span> LC_IDENTIFICATION<span class="ot">=</span>C   </span>
<span id="cb71-15"><a href="#cb71-15" tabindex="-1"></a></span>
<span id="cb71-16"><a href="#cb71-16" tabindex="-1"></a>time zone<span class="sc">:</span> UTC</span>
<span id="cb71-17"><a href="#cb71-17" tabindex="-1"></a>tzcode source<span class="sc">:</span> <span class="fu">system</span> (glibc)</span>
<span id="cb71-18"><a href="#cb71-18" tabindex="-1"></a></span>
<span id="cb71-19"><a href="#cb71-19" tabindex="-1"></a>attached base packages<span class="sc">:</span></span>
<span id="cb71-20"><a href="#cb71-20" tabindex="-1"></a>[<span class="dv">1</span>] stats     graphics  grDevices utils     datasets  methods   base     </span>
<span id="cb71-21"><a href="#cb71-21" tabindex="-1"></a></span>
<span id="cb71-22"><a href="#cb71-22" tabindex="-1"></a>other attached packages<span class="sc">:</span></span>
<span id="cb71-23"><a href="#cb71-23" tabindex="-1"></a> [<span class="dv">1</span>] data.table_1.<span class="fl">16.2</span> lubridate_1.<span class="fl">9.3</span>   forcats_1.<span class="fl">0.0</span>     stringr_1.<span class="fl">5.1</span>    </span>
<span id="cb71-24"><a href="#cb71-24" tabindex="-1"></a> [<span class="dv">5</span>] dplyr_1.<span class="fl">1.4</span>       purrr_1.<span class="fl">0.2</span>       readr_2.<span class="fl">1.5</span>       tidyr_1.<span class="fl">3.1</span>      </span>
<span id="cb71-25"><a href="#cb71-25" tabindex="-1"></a> [<span class="dv">9</span>] tibble_3.<span class="fl">2.1</span>      tidyverse_2.<span class="fl">0.0</span>   ggplot2_3.<span class="fl">5.1</span>    </span>
<span id="cb71-26"><a href="#cb71-26" tabindex="-1"></a></span>
<span id="cb71-27"><a href="#cb71-27" tabindex="-1"></a>loaded via a <span class="fu">namespace</span> (and not attached)<span class="sc">:</span></span>
<span id="cb71-28"><a href="#cb71-28" tabindex="-1"></a> [<span class="dv">1</span>] bit_4.<span class="fl">5.0</span>        gtable_0.<span class="fl">3.6</span>     crayon_1.<span class="fl">5.3</span>     compiler_4.<span class="fl">4.2</span>  </span>
<span id="cb71-29"><a href="#cb71-29" tabindex="-1"></a> [<span class="dv">5</span>] renv_1.<span class="fl">0.11</span>      tidyselect_1.<span class="fl">2.1</span> parallel_4.<span class="fl">4.2</span>   scales_1.<span class="fl">3.0</span>    </span>
<span id="cb71-30"><a href="#cb71-30" tabindex="-1"></a> [<span class="dv">9</span>] yaml_2.<span class="fl">3.10</span>      R6_2.<span class="fl">5.1</span>         generics_0.<span class="fl">1.3</span>   knitr_1<span class="fl">.49</span>      </span>
<span id="cb71-31"><a href="#cb71-31" tabindex="-1"></a>[<span class="dv">13</span>] munsell_0.<span class="fl">5.1</span>    pillar_1.<span class="fl">9.0</span>     tzdb_0.<span class="fl">4.0</span>       rlang_1.<span class="fl">1.4</span>     </span>
<span id="cb71-32"><a href="#cb71-32" tabindex="-1"></a>[<span class="dv">17</span>] utf8_1.<span class="fl">2.4</span>       stringi_1.<span class="fl">8.4</span>    xfun_0<span class="fl">.49</span>        bit64_4.<span class="fl">5.2</span>     </span>
<span id="cb71-33"><a href="#cb71-33" tabindex="-1"></a>[<span class="dv">21</span>] timechange_0.<span class="fl">3.0</span> cli_3.<span class="fl">6.3</span>        withr_3.<span class="fl">0.2</span>      magrittr_2.<span class="fl">0.3</span>  </span>
<span id="cb71-34"><a href="#cb71-34" tabindex="-1"></a>[<span class="dv">25</span>] grid_4.<span class="fl">4.2</span>       vroom_1.<span class="fl">6.5</span>      hms_1.<span class="fl">1.3</span>        lifecycle_1.<span class="fl">0.4</span> </span>
<span id="cb71-35"><a href="#cb71-35" tabindex="-1"></a>[<span class="dv">29</span>] vctrs_0.<span class="fl">6.5</span>      evaluate_1.<span class="fl">0.1</span>   glue_1.<span class="fl">8.0</span>       fansi_1.<span class="fl">0.6</span>     </span>
<span id="cb71-36"><a href="#cb71-36" tabindex="-1"></a>[<span class="dv">33</span>] colorspace_2<span class="fl">.1</span><span class="dv">-1</span> tools_4.<span class="fl">4.2</span>      pkgconfig_2.<span class="fl">0.3</span> </span></code></pre>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></div> <!-- / div.lesson-content -->
    </main><!-- / main#main-content.main-content --><nav class="bottom-pagination mx-md-4" aria-label="Previous and Next Chapter"><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="differential-expression-analysis.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="index.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="differential-expression-analysis.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: Differential
        </a>
        <a class="chapter-link float-end" href="index.html" rel="next">
          Home
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
    </nav></div> <!-- / div.primary-content.col-xs-12 -->
<!-- END:   inst/pkgdown/templates/content-instructor.html-->

      </div><!--/div.row-->
      		<footer class="row footer mx-md-3"><hr><div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>

        <a href="https://github.com/carpentries/workbench-template-md/edit/main/episodes/mouse-human-alignment.Rmd" class="external-link">Edit on GitHub</a>

	
        | <a href="https://github.com/carpentries/workbench-template-md/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/carpentries/workbench-template-md/" class="external-link">Source</a></p>
				<p><a href="https://github.com/carpentries/workbench-template-md/blob/main/CITATION.cff" class="external-link">Cite</a> | <a href="mailto:team@carpentries.org">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">

        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>

        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.16.10" class="external-link">sandpaper (0.16.10)</a>, <a href="https://github.com/carpentries/pegboard/tree/0.7.7" class="external-link">pegboard (0.7.7)</a>, and <a href="https://github.com/carpentries/varnish/tree/1.0.5" class="external-link">varnish (1.0.5)</a></p>
			</div>
		</footer></div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://carpentries.github.io/workbench-template-md/mouse-human-alignment.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "Alzheimers, data, lesson, MODEL-AD",
  "name": "Mouse-human alignment of transcriptomic signatures",
  "creativeWorkStatus": "active",
  "url": "https://carpentries.github.io/workbench-template-md/mouse-human-alignment.html",
  "identifier": "https://carpentries.github.io/workbench-template-md/mouse-human-alignment.html",
  "dateCreated": "2024-07-24",
  "dateModified": "2024-11-19",
  "datePublished": "2024-11-19"
}

  </script><script>
		feather.replace();
	</script></body></html><!-- END:   inst/pkgdown/templates/layout.html-->

